<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>National Transit Sustainability Report – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0cb5735cee7cc8ae56ecf7c7052d4876.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary"><strong>Executive Summary</strong></a>
  <ul class="collapse">
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings"><strong>Key Findings</strong></a></li>
  </ul></li>
  <li><a href="#task---1-data-import" id="toc-task---1-data-import" class="nav-link" data-scroll-target="#task---1-data-import"><strong>Task - 1 Data Import</strong></a>
  <ul class="collapse">
  <li><a href="#eia-sip-report-arranged-in-decreasing-co2-emission" id="toc-eia-sip-report-arranged-in-decreasing-co2-emission" class="nav-link" data-scroll-target="#eia-sip-report-arranged-in-decreasing-co2-emission">EIA SIP REPORT (Arranged in decreasing CO2 emission)</a></li>
  </ul></li>
  <li><a href="#task-2-data-exploring" id="toc-task-2-data-exploring" class="nav-link" data-scroll-target="#task-2-data-exploring"><strong>Task-2 Data Exploring</strong></a>
  <ul class="collapse">
  <li><a href="#annual-database-energy-consumption" id="toc-annual-database-energy-consumption" class="nav-link" data-scroll-target="#annual-database-energy-consumption">2023 Annual Database Energy Consumption</a></li>
  </ul></li>
  <li><a href="#task---3-analysis-of-transit-data-recoding-modes" id="toc-task---3-analysis-of-transit-data-recoding-modes" class="nav-link" data-scroll-target="#task---3-analysis-of-transit-data-recoding-modes"><strong>Task - 3 Analysis of Transit Data &amp; Recoding Modes</strong></a>
  <ul class="collapse">
  <li><a href="#service-data" id="toc-service-data" class="nav-link" data-scroll-target="#service-data">2023 service data</a></li>
  </ul></li>
  <li><a href="#task-4-exploring-ntd-service-data" id="toc-task-4-exploring-ntd-service-data" class="nav-link" data-scroll-target="#task-4-exploring-ntd-service-data"><strong>TASK-4 Exploring NTD Service Data</strong></a></li>
  <li><a href="#task-5-calculating-total-emissions" id="toc-task-5-calculating-total-emissions" class="nav-link" data-scroll-target="#task-5-calculating-total-emissions"><strong>Task-5: Calculating Total Emissions</strong></a>
  <ul class="collapse">
  <li><a href="#analysis-steps" id="toc-analysis-steps" class="nav-link" data-scroll-target="#analysis-steps">Analysis Steps</a></li>
  <li><a href="#agency-level-emission" id="toc-agency-level-emission" class="nav-link" data-scroll-target="#agency-level-emission">Agency level emission</a></li>
  <li><a href="#detailed-fuel-breakdown" id="toc-detailed-fuel-breakdown" class="nav-link" data-scroll-target="#detailed-fuel-breakdown">Detailed Fuel Breakdown</a></li>
  <li><a href="#state-level-emission-intensity" id="toc-state-level-emission-intensity" class="nav-link" data-scroll-target="#state-level-emission-intensity">State-Level Emission Intensity</a></li>
  </ul></li>
  <li><a href="#task-6-normalizing-emissions-to-transit-usage" id="toc-task-6-normalizing-emissions-to-transit-usage" class="nav-link" data-scroll-target="#task-6-normalizing-emissions-to-transit-usage"><strong>Task-6: Normalizing Emissions to Transit Usage</strong></a>
  <ul class="collapse">
  <li><a href="#analysis-overview" id="toc-analysis-overview" class="nav-link" data-scroll-target="#analysis-overview">Analysis Overview</a></li>
  <li><a href="#efficiency-metrics" id="toc-efficiency-metrics" class="nav-link" data-scroll-target="#efficiency-metrics"><em>Efficiency Metrics</em></a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">Summary statistics</a></li>
  </ul></li>
  <li><a href="#task-7-identifying-transit-sustainability-leaders" id="toc-task-7-identifying-transit-sustainability-leaders" class="nav-link" data-scroll-target="#task-7-identifying-transit-sustainability-leaders"><strong>Task-7: Identifying Transit Sustainability Leaders</strong></a>
  <ul class="collapse">
  <li><a href="#greenest-transit-agencies" id="toc-greenest-transit-agencies" class="nav-link" data-scroll-target="#greenest-transit-agencies">🍃 1. Greenest Transit Agencies</a></li>
  <li><a href="#most-emissions-avoided" id="toc-most-emissions-avoided" class="nav-link" data-scroll-target="#most-emissions-avoided">♻️ 2. Most Emissions Avoided</a></li>
  <li><a href="#electrification-leaders" id="toc-electrification-leaders" class="nav-link" data-scroll-target="#electrification-leaders">⚡ 3. Electrification Leaders</a></li>
  <li><a href="#summary-of-top-performers" id="toc-summary-of-top-performers" class="nav-link" data-scroll-target="#summary-of-top-performers">🏆 Summary of Top Performers</a></li>
  </ul></li>
  <li><a href="#step-8-awards-visualization-with-median-references" id="toc-step-8-awards-visualization-with-median-references" class="nav-link" data-scroll-target="#step-8-awards-visualization-with-median-references"><strong>Step-8 Awards visualization with Median references</strong></a>
  <ul class="collapse">
  <li><a href="#visualization-1-greenest-transit-agencies-co2-per-passenger-mile" id="toc-visualization-1-greenest-transit-agencies-co2-per-passenger-mile" class="nav-link" data-scroll-target="#visualization-1-greenest-transit-agencies-co2-per-passenger-mile">Visualization 1: Greenest Transit Agencies (CO2 per passenger mile)</a></li>
  <li><a href="#visualization-2-most-emissions-avoided" id="toc-visualization-2-most-emissions-avoided" class="nav-link" data-scroll-target="#visualization-2-most-emissions-avoided">Visualization 2: Most Emissions Avoided</a></li>
  <li><a href="#visualization-3-electrification-leaders" id="toc-visualization-3-electrification-leaders" class="nav-link" data-scroll-target="#visualization-3-electrification-leaders">Visualization 3: Electrification Leaders</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>Conclusion</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>National Transit Sustainability Report</strong></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary"><strong>Executive Summary</strong></h2>
<p>This report provides a comprehensive analysis of transit agency environmental performance across the United States, leveraging data from the National Transit Database (NTD) and state-level energy information. By examining emissions, energy consumption, and service metrics, we offer unprecedented insights into the environmental impact and sustainability of public transit systems.</p>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings"><strong>Key Findings</strong></h3>
<section id="emissions-performance" class="level4">
<h4 class="anchored" data-anchor-id="emissions-performance"><em>Emissions Performance</em></h4>
<ul>
<li>The national weighted average CO₂ emissions for transit is approximately 1,030 pounds per megawatt-hour of electricity generated.</li>
<li>Significant variations exist between states, with some states producing over 50% more emissions than others in transit energy production.</li>
</ul>
</section>
<section id="agency-level-sustainability" class="level4">
<h4 class="anchored" data-anchor-id="agency-level-sustainability"><em>Agency-Level Sustainability</em></h4>
<p><em>Greenest Transit Agencies</em> - Top-performing agencies achieve remarkably low emissions, with some delivering service at less than 0.1 pounds of CO₂ per passenger mile. - Large transit agencies demonstrate 25-30% better median efficiency compared to smaller agencies.</p>
<p><em>Emissions Avoidance</em> - Leading transit agencies prevent emissions equivalent to removing 10,000+ cars from roads annually. - These systems provide critical environmental benefits by offering sustainable transportation alternatives.</p>
</section>
<section id="electrification-trends" class="level4">
<h4 class="anchored" data-anchor-id="electrification-trends"><em>Electrification Trends</em></h4>
<ul>
<li>While some agencies have achieved 100% electrification, the median electric fuel usage remains below 30%.</li>
<li>Significant opportunities exist for industry-wide transition to electric and low-carbon transit solutions.</li>
</ul>
</section>
</section>
</section>
<section id="task---1-data-import" class="level2">
<h2 class="anchored" data-anchor-id="task---1-data-import"><strong>Task - 1 Data Import</strong></h2>
<div class="cell" data-caption="Data Import Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>get_eia_sep <span class="ot">&lt;-</span> <span class="cf">function</span>(state, abbr){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  state_formatted <span class="ot">&lt;-</span> <span class="fu">str_to_lower</span>(state) <span class="sc">|&gt;</span> <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  dir_name <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_name, state_formatted)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(dir_name, <span class="at">showWarnings=</span><span class="cn">FALSE</span>, <span class="at">recursive=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(file_name)){</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    BASE_URL <span class="ot">&lt;-</span> <span class="st">"https://www.eia.gov"</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    REQUEST <span class="ot">&lt;-</span> <span class="fu">request</span>(BASE_URL) <span class="sc">|&gt;</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req_url_path</span>(<span class="st">"electricity"</span>, <span class="st">"state"</span>, state_formatted)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    RESPONSE <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(REQUEST)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">resp_check_status</span>(RESPONSE)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(RESPONSE), file_name)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  TABLE <span class="ot">&lt;-</span> <span class="fu">read_html</span>(file_name) <span class="sc">|&gt;</span> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Item =</span> <span class="fu">str_to_lower</span>(Item))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">"U.S. rank"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(TABLE)){</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    TABLE <span class="ot">&lt;-</span> TABLE <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">Rank =</span> <span class="st">`</span><span class="at">U.S. rank</span><span class="st">`</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  CO2_MWh <span class="ot">&lt;-</span> TABLE <span class="sc">|&gt;</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Item <span class="sc">==</span> <span class="st">"carbon dioxide (lbs/mwh)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value) <span class="sc">|&gt;</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  PRIMARY <span class="ot">&lt;-</span> TABLE <span class="sc">|&gt;</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Item <span class="sc">==</span> <span class="st">"primary energy source"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Rank)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  RATE <span class="ot">&lt;-</span> TABLE <span class="sc">|&gt;</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Item <span class="sc">==</span> <span class="st">"average retail price (cents/kwh)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value) <span class="sc">|&gt;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  GENERATION_MWh <span class="ot">&lt;-</span> TABLE <span class="sc">|&gt;</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Item <span class="sc">==</span> <span class="st">"net generation (megawatthours)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value) <span class="sc">|&gt;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">CO2_MWh               =</span> CO2_MWh, </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">primary_source        =</span> PRIMARY,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">electricity_price_MWh =</span> RATE <span class="sc">*</span> <span class="dv">10</span>, <span class="co"># / 100 cents to dollars &amp;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>             <span class="co"># * 1000 kWh to MWH </span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">generation_MWh        =</span> GENERATION_MWh, </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">state                 =</span> state, </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">abbreviation          =</span> abbr</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>EIA_SEP_REPORT <span class="ot">&lt;-</span> <span class="fu">map2</span>(state.name, state.abb, get_eia_sep) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="eia-sip-report-arranged-in-decreasing-co2-emission" class="level3">
<h3 class="anchored" data-anchor-id="eia-sip-report-arranged-in-decreasing-co2-emission">EIA SIP REPORT (Arranged in decreasing CO2 emission)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>EIA_SEP_REPORT <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>abbreviation) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(CO2_MWh)) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CO2_MWh =</span> <span class="fu">number</span>(CO2_MWh, <span class="at">big.mark=</span><span class="st">","</span>), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">electricity_price_MWh =</span> <span class="fu">dollar</span>(electricity_price_MWh), </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">generation_MWh =</span> <span class="fu">number</span>(generation_MWh, <span class="at">big.mark=</span><span class="st">","</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Pounds of CO2 Emitted per MWh</span><span class="st">`</span> <span class="ot">=</span> CO2_MWh, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Primary Energy Source</span><span class="st">`</span> <span class="ot">=</span> primary_source,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Price per MWh</span><span class="st">`</span> <span class="ot">=</span> electricity_price_MWh,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Generation (MWh)</span><span class="st">`</span> <span class="ot">=</span> generation_MWh,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">State =</span> state) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"State Electricity Profiles"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>State Electricity Profiles</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Pounds of CO2 Emitted per MWh</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Primary Energy Source</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Price per MWh</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Generation (MWh)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">State</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1,925</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$102.60</td>
<td style="text-align: left;">52,286,784</td>
<td style="text-align: left;">West Virginia</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,864</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$83.90</td>
<td style="text-align: left;">43,181,420</td>
<td style="text-align: left;">Wyoming</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,741</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$99.60</td>
<td style="text-align: left;">63,217,080</td>
<td style="text-align: left;">Kentucky</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,514</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$108.70</td>
<td style="text-align: left;">66,703,285</td>
<td style="text-align: left;">Missouri</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,497</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$114.90</td>
<td style="text-align: left;">90,046,880</td>
<td style="text-align: left;">Indiana</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,444</td>
<td style="text-align: left;">Petroleum</td>
<td style="text-align: left;">$386.00</td>
<td style="text-align: left;">9,194,164</td>
<td style="text-align: left;">Hawaii</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,414</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$80.30</td>
<td style="text-align: left;">42,068,807</td>
<td style="text-align: left;">North Dakota</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,354</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$90.30</td>
<td style="text-align: left;">33,496,554</td>
<td style="text-align: left;">Utah</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,180</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$214.10</td>
<td style="text-align: left;">6,717,825</td>
<td style="text-align: left;">Alaska</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,148</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$127.20</td>
<td style="text-align: left;">62,548,705</td>
<td style="text-align: left;">Wisconsin</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,127</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$109.70</td>
<td style="text-align: left;">26,895,758</td>
<td style="text-align: left;">Montana</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,103</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$91.40</td>
<td style="text-align: left;">39,445,955</td>
<td style="text-align: left;">Nebraska</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,095</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$128.50</td>
<td style="text-align: left;">4,772,059</td>
<td style="text-align: left;">Delaware</td>
</tr>
<tr class="even">
<td style="text-align: left;">1,054</td>
<td style="text-align: left;">Coal</td>
<td style="text-align: left;">$117.60</td>
<td style="text-align: left;">57,541,720</td>
<td style="text-align: left;">Colorado</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,044</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$110.40</td>
<td style="text-align: left;">133,223,464</td>
<td style="text-align: left;">Ohio</td>
</tr>
<tr class="even">
<td style="text-align: left;">987</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$97.30</td>
<td style="text-align: left;">63,195,647</td>
<td style="text-align: left;">Arkansas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">966</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$89.10</td>
<td style="text-align: left;">97,784,565</td>
<td style="text-align: left;">Louisiana</td>
</tr>
<tr class="even">
<td style="text-align: left;">923</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$232.10</td>
<td style="text-align: left;">19,695,884</td>
<td style="text-align: left;">Massachusetts</td>
</tr>
<tr class="odd">
<td style="text-align: left;">912</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$136.80</td>
<td style="text-align: left;">120,656,625</td>
<td style="text-align: left;">Michigan</td>
</tr>
<tr class="even">
<td style="text-align: left;">855</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$100.40</td>
<td style="text-align: left;">547,294,552</td>
<td style="text-align: left;">Texas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">847</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$216.20</td>
<td style="text-align: left;">10,430,846</td>
<td style="text-align: left;">Rhode Island</td>
</tr>
<tr class="even">
<td style="text-align: left;">817</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$109.50</td>
<td style="text-align: left;">72,933,440</td>
<td style="text-align: left;">Mississippi</td>
</tr>
<tr class="odd">
<td style="text-align: left;">801</td>
<td style="text-align: left;">Wind</td>
<td style="text-align: left;">$122.10</td>
<td style="text-align: left;">57,276,862</td>
<td style="text-align: left;">Minnesota</td>
</tr>
<tr class="even">
<td style="text-align: left;">794</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$135.30</td>
<td style="text-align: left;">259,798,479</td>
<td style="text-align: left;">Florida</td>
</tr>
<tr class="odd">
<td style="text-align: left;">775</td>
<td style="text-align: left;">Wind</td>
<td style="text-align: left;">$94.20</td>
<td style="text-align: left;">69,836,973</td>
<td style="text-align: left;">Iowa</td>
</tr>
<tr class="even">
<td style="text-align: left;">763</td>
<td style="text-align: left;">Wind</td>
<td style="text-align: left;">$108.00</td>
<td style="text-align: left;">58,456,598</td>
<td style="text-align: left;">Kansas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">759</td>
<td style="text-align: left;">Wind</td>
<td style="text-align: left;">$94.70</td>
<td style="text-align: left;">39,269,073</td>
<td style="text-align: left;">New Mexico</td>
</tr>
<tr class="even">
<td style="text-align: left;">733</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$110.60</td>
<td style="text-align: left;">129,221,513</td>
<td style="text-align: left;">Georgia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">727</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$114.70</td>
<td style="text-align: left;">139,435,010</td>
<td style="text-align: left;">Alabama</td>
</tr>
<tr class="even">
<td style="text-align: left;">715</td>
<td style="text-align: left;">Nuclear</td>
<td style="text-align: left;">$106.90</td>
<td style="text-align: left;">77,791,204</td>
<td style="text-align: left;">Tennessee</td>
</tr>
<tr class="odd">
<td style="text-align: left;">684</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$121.90</td>
<td style="text-align: left;">111,838,736</td>
<td style="text-align: left;">Arizona</td>
</tr>
<tr class="even">
<td style="text-align: left;">655</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$125.70</td>
<td style="text-align: left;">235,924,937</td>
<td style="text-align: left;">Pennsylvania</td>
</tr>
<tr class="odd">
<td style="text-align: left;">654</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$130.90</td>
<td style="text-align: left;">42,164,375</td>
<td style="text-align: left;">Nevada</td>
</tr>
<tr class="even">
<td style="text-align: left;">648</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$93.00</td>
<td style="text-align: left;">89,236,024</td>
<td style="text-align: left;">Oklahoma</td>
</tr>
<tr class="odd">
<td style="text-align: left;">639</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$106.10</td>
<td style="text-align: left;">126,553,394</td>
<td style="text-align: left;">North Carolina</td>
</tr>
<tr class="even">
<td style="text-align: left;">594</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$106.80</td>
<td style="text-align: left;">91,059,344</td>
<td style="text-align: left;">Virginia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">576</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$242.40</td>
<td style="text-align: left;">40,666,418</td>
<td style="text-align: left;">Connecticut</td>
</tr>
<tr class="even">
<td style="text-align: left;">558</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$143.40</td>
<td style="text-align: left;">36,000,650</td>
<td style="text-align: left;">Maryland</td>
</tr>
<tr class="odd">
<td style="text-align: left;">558</td>
<td style="text-align: left;">Nuclear</td>
<td style="text-align: left;">$105.00</td>
<td style="text-align: left;">100,853,387</td>
<td style="text-align: left;">South Carolina</td>
</tr>
<tr class="even">
<td style="text-align: left;">522</td>
<td style="text-align: left;">Nuclear</td>
<td style="text-align: left;">$117.50</td>
<td style="text-align: left;">177,737,641</td>
<td style="text-align: left;">Illinois</td>
</tr>
<tr class="odd">
<td style="text-align: left;">522</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$182.80</td>
<td style="text-align: left;">124,039,988</td>
<td style="text-align: left;">New York</td>
</tr>
<tr class="even">
<td style="text-align: left;">518</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$152.70</td>
<td style="text-align: left;">64,228,924</td>
<td style="text-align: left;">New Jersey</td>
</tr>
<tr class="odd">
<td style="text-align: left;">440</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$248.70</td>
<td style="text-align: left;">216,628,794</td>
<td style="text-align: left;">California</td>
</tr>
<tr class="even">
<td style="text-align: left;">428</td>
<td style="text-align: left;">Natural gas</td>
<td style="text-align: left;">$208.40</td>
<td style="text-align: left;">12,512,181</td>
<td style="text-align: left;">Maine</td>
</tr>
<tr class="odd">
<td style="text-align: left;">370</td>
<td style="text-align: left;">Hydroelectric</td>
<td style="text-align: left;">$90.80</td>
<td style="text-align: left;">17,842,446</td>
<td style="text-align: left;">Idaho</td>
</tr>
<tr class="even">
<td style="text-align: left;">369</td>
<td style="text-align: left;">Wind</td>
<td style="text-align: left;">$104.90</td>
<td style="text-align: left;">17,436,158</td>
<td style="text-align: left;">South Dakota</td>
</tr>
<tr class="odd">
<td style="text-align: left;">344</td>
<td style="text-align: left;">Hydroelectric</td>
<td style="text-align: left;">$103.20</td>
<td style="text-align: left;">61,691,869</td>
<td style="text-align: left;">Oregon</td>
</tr>
<tr class="even">
<td style="text-align: left;">292</td>
<td style="text-align: left;">Hydroelectric</td>
<td style="text-align: left;">$95.80</td>
<td style="text-align: left;">102,960,605</td>
<td style="text-align: left;">Washington</td>
</tr>
<tr class="odd">
<td style="text-align: left;">269</td>
<td style="text-align: left;">Nuclear</td>
<td style="text-align: left;">$229.60</td>
<td style="text-align: left;">16,824,999</td>
<td style="text-align: left;">New Hampshire</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Hydroelectric</td>
<td style="text-align: left;">$175.30</td>
<td style="text-align: left;">2,480,199</td>
<td style="text-align: left;">Vermont</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</section>
</section>
<section id="task-2-data-exploring" class="level2">
<h2 class="anchored" data-anchor-id="task-2-data-exploring"><strong>Task-2 Data Exploring</strong></h2>
<p><strong>1. Most Expensive Retail Electricity</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>most_expensive <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(electricity_price_MWh)) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">State =</span> state, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Price per MWh</span><span class="st">`</span> <span class="ot">=</span> electricity_price_MWh) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Price per MWh</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dollar</span>(<span class="st">`</span><span class="at">Price per MWh</span><span class="st">`</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(most_expensive, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"State with Most Expensive Electricity"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>State with Most Expensive Electricity</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price per MWh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hawaii</td>
<td style="text-align: left;">$386</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>2. Dirtiest Electricity mix</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dirtiest <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(CO2_MWh)) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">State =</span> state, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span> <span class="ot">=</span> CO2_MWh) <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">number</span>(<span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span>, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dirtiest, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"State with Dirtiest Electricity Generation"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>State with Dirtiest Electricity Generation</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CO₂ lbs/MWh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">West Virginia</td>
<td style="text-align: left;">1,925</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The state with the dirtiest electricity mix is"</span>, dirtiest<span class="sc">$</span>State, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"with"</span>, dirtiest<span class="sc">$</span><span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span>, <span class="st">"pounds of CO₂ emitted per MWh."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The state with the dirtiest electricity mix is West Virginia with 1,925 pounds of CO₂ emitted per MWh.</code></pre>
</div>
</div>
<p><strong>3. National weighted average CO2 emission</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>weighted_avg <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Weighted Avg CO₂ (lbs/MWh)</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">sum</span>(CO2_MWh <span class="sc">*</span> generation_MWh) <span class="sc">/</span> <span class="fu">sum</span>(generation_MWh)))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(weighted_avg, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"National Weighted Average CO₂ Emissions"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>National Weighted Average CO₂ Emissions</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Weighted Avg CO₂ (lbs/MWh)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">805</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>4. Rarest Primary energy source</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rarest_info <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(primary_source) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(n, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(EIA_SEP_REPORT, <span class="at">by =</span> <span class="st">"primary_source"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(primary_source) <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Avg Price</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dollar</span>(<span class="fu">mean</span>(electricity_price_MWh)),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">States =</span> <span class="fu">paste</span>(<span class="fu">unique</span>(state), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Energy Source</span><span class="st">`</span> <span class="ot">=</span> primary_source)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(rarest_info, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Rarest Primary Energy Source in the US"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Rarest Primary Energy Source in the US</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Energy Source</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Avg Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">States</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Petroleum</td>
<td style="text-align: left;">$386</td>
<td style="text-align: left;">Hawaii</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>5. Texas vs New York Energy Cleanliness</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First calculate the ratio using original numeric values</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tx_co2 <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Texas"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CO2_MWh)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ny_co2 <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"New York"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CO2_MWh)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>cleanliness_ratio <span class="ot">&lt;-</span> tx_co2 <span class="sc">/</span> ny_co2</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the display table with formatted numbers</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> EIA_SEP_REPORT <span class="sc">|&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Texas"</span>, <span class="st">"New York"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">State =</span> state, </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span> <span class="ot">=</span> CO2_MWh) <span class="sc">|&gt;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">number</span>(<span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span>, <span class="at">big.mark =</span> <span class="st">","</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">State =</span> <span class="st">"Cleanliness Ratio"</span>, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">CO₂ lbs/MWh</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">round</span>(cleanliness_ratio, <span class="dv">2</span>)))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison, </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Energy Cleanliness: Texas vs New York"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="fu">paste</span>(<span class="st">"New York's energy mix is"</span>, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(cleanliness_ratio, <span class="dv">2</span>),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"times cleaner than Texas'"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Energy Cleanliness: Texas vs New York</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CO₂ lbs/MWh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">New York</td>
<td style="text-align: left;">522</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Texas</td>
<td style="text-align: left; font-weight: bold;">855</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cleanliness Ratio</td>
<td style="text-align: left;">1.64</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> New York's energy mix is 1.64 times cleaner than Texas'</td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<section id="annual-database-energy-consumption" class="level3">
<h3 class="anchored" data-anchor-id="annual-database-energy-consumption">2023 Annual Database Energy Consumption</h3>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of 2023 NTD Energy Consumption Data</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">NTD ID</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Mode</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Agency Name</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Bio-Diesel</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Bunker Fuel</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">C Natural Gas</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Diesel Fuel</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Electric Battery</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Electric Propulsion</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Ethanol</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Methonal</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Gasoline</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Hydrogen</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Kerosene</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Liquified Nat Gas</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Liquified Petroleum Gas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">40030</td>
<td style="text-align: left;">MB</td>
<td style="text-align: left;">City of Gainesville, FL</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">736614</td>
<td style="text-align: right;">89083</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">22250</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">40058</td>
<td style="text-align: left;">DR</td>
<td style="text-align: left;">City of Rome</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17117</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20018</td>
<td style="text-align: left;">MB</td>
<td style="text-align: left;">Central New York Regional Transportation Authority</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">723405</td>
<td style="text-align: right;">318038</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">40180</td>
<td style="text-align: left;">DR</td>
<td style="text-align: left;">University of Georgia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1290</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3424</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20080</td>
<td style="text-align: left;">YR</td>
<td style="text-align: left;">New Jersey Transit Corporation</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">550499</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">90012</td>
<td style="text-align: left;">CB</td>
<td style="text-align: left;">San Joaquin Regional Transit District</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52935</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">90136</td>
<td style="text-align: left;">VP</td>
<td style="text-align: left;">Regional Public Transportation Authority</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">244868</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">50113</td>
<td style="text-align: left;">DR</td>
<td style="text-align: left;">Pace, the Suburban Bus Division of the Regional Transportation Authority</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">567111</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">50031</td>
<td style="text-align: left;">DR</td>
<td style="text-align: left;">Suburban Mobility Authority for Regional Transportation</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">42729</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1720</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">606341</td>
</tr>
<tr class="even">
<td style="text-align: left;">50191</td>
<td style="text-align: left;">VP</td>
<td style="text-align: left;">Mid-Ohio Regional Planning Commission</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20419</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</section>
</section>
<section id="task---3-analysis-of-transit-data-recoding-modes" class="level2">
<h2 class="anchored" data-anchor-id="task---3-analysis-of-transit-data-recoding-modes"><strong>Task - 3 Analysis of Transit Data &amp; Recoding Modes</strong></h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Transit Mode Code Translation</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; background-color: rgba(247, 247, 247, 255) !important;">Code</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; background-color: rgba(247, 247, 247, 255) !important;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">AR</td>
<td style="text-align: left; width: 20em;">Aerial Tramway</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">CB</td>
<td style="text-align: left; width: 20em;">Alaska Railroad</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">CC</td>
<td style="text-align: left; width: 20em;">Bus</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">CR</td>
<td style="text-align: left; width: 20em;">Bus Rapid Transit</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">DR</td>
<td style="text-align: left; width: 20em;">Cable Car</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">FB</td>
<td style="text-align: left; width: 20em;">Commuter Bus</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">HR</td>
<td style="text-align: left; width: 20em;">Commuter Rail</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">IP</td>
<td style="text-align: left; width: 20em;">Demand Response</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">LR</td>
<td style="text-align: left; width: 20em;">Ferryboat</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">MB</td>
<td style="text-align: left; width: 20em;">Heavy Rail</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">MG</td>
<td style="text-align: left; width: 20em;">Hybrid Rail</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">PB</td>
<td style="text-align: left; width: 20em;">Inclined Plane</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">RB</td>
<td style="text-align: left; width: 20em;">Light Rail</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">SR</td>
<td style="text-align: left; width: 20em;">Publico</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">TB</td>
<td style="text-align: left; width: 20em;">Streetcar Rail</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">TR</td>
<td style="text-align: left; width: 20em;">Ted Guideway</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3em; font-weight: bold;">VP</td>
<td style="text-align: left; width: 20em;">Trolleybus</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3em; font-weight: bold;">YR</td>
<td style="text-align: left; width: 20em;">Vanpool</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note:</span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Complete mapping of original codes to descriptive names</td>
<td style="text-align: left;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<section id="service-data" class="level3">
<h3 class="anchored" data-anchor-id="service-data">2023 service data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and process service data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE_FILE <span class="ot">&lt;-</span> <span class="fu">file.path</span>(DATA_DIR, <span class="st">"2023_service.csv"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(NTD_SERVICE_FILE)){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(<span class="st">"https://data.transportation.gov/resource/6y83-7vuw.csv"</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">destfile =</span> NTD_SERVICE_FILE, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"curl"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Failed to download NTD Service File. Please try again later."</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE_RAW <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(NTD_SERVICE_FILE)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="ot">&lt;-</span> NTD_SERVICE_RAW <span class="sc">|&gt;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">_5_digit_ntd_id</span><span class="st">`</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Agency =</span> agency,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">City =</span> max_city,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">State =</span> max_state,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">UPT =</span> sum_unlinked_passenger_trips_upt,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">MILES =</span> sum_passenger_miles) <span class="sc">|&gt;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">"^[A-Z]"</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MILES <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display sample</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="sc">|&gt;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of 2023 Transit Service Data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of 2023 Service Data</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Agency</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">City</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">State</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">UPT</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">MILES</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">NTD ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Transit Authority of River City</td>
<td style="text-align: left;">Louisville</td>
<td style="text-align: left;">KY</td>
<td style="text-align: right;">6247087</td>
<td style="text-align: right;">22882994</td>
<td style="text-align: right;">40018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Whatcom Transportation Authority</td>
<td style="text-align: left;">Bellingham</td>
<td style="text-align: left;">WA</td>
<td style="text-align: right;">3724696</td>
<td style="text-align: right;">11921726</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Board of County Commissioners, Palm Beach County, dba: Palm Tran, Inc.</td>
<td style="text-align: left;">West Palm Beach</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">8468040</td>
<td style="text-align: right;">50539296</td>
<td style="text-align: right;">40037</td>
</tr>
<tr class="even">
<td style="text-align: left;">Greater Lynchburg Transit Company</td>
<td style="text-align: left;">Lynchburg</td>
<td style="text-align: left;">VA</td>
<td style="text-align: right;">520122</td>
<td style="text-align: right;">2306018</td>
<td style="text-align: right;">30008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lake County Board of County Commissioners, dba: LakeXpress</td>
<td style="text-align: left;">Tavares</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">289663</td>
<td style="text-align: right;">2164266</td>
<td style="text-align: right;">40158</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mecklenburg County , dba: Mecklenburg Transportation System</td>
<td style="text-align: left;">Charlotte</td>
<td style="text-align: left;">NC</td>
<td style="text-align: right;">349575</td>
<td style="text-align: right;">3143856</td>
<td style="text-align: right;">40228</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City of Eau Claire, dba: Eau Claire Transit</td>
<td style="text-align: left;">Eau Claire</td>
<td style="text-align: left;">WI</td>
<td style="text-align: right;">672882</td>
<td style="text-align: right;">1868624</td>
<td style="text-align: right;">50099</td>
</tr>
<tr class="even">
<td style="text-align: left;">County Commissioners of Charles County, MD, dba: PGM VanGO</td>
<td style="text-align: left;">La Plata</td>
<td style="text-align: left;">MD</td>
<td style="text-align: right;">542316</td>
<td style="text-align: right;">4398362</td>
<td style="text-align: right;">30088</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Academy Lines, Inc., dba: Academy</td>
<td style="text-align: left;">Hoboken</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">1064165</td>
<td style="text-align: right;">44972754</td>
<td style="text-align: right;">20122</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hudson Transit Lines, Inc., dba: Short Line</td>
<td style="text-align: left;">Mahwah</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">1832789</td>
<td style="text-align: right;">93151932</td>
<td style="text-align: right;">20126</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</section>
</section>
<section id="task-4-exploring-ntd-service-data" class="level2">
<h2 class="anchored" data-anchor-id="task-4-exploring-ntd-service-data"><strong>TASK-4 Exploring NTD Service Data</strong></h2>
<p><strong>1. Agency with Highest Annual Ridership</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 3 Transit Agencies by Annual Ridership</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Annual Passenger Trips</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 25em;">Rockford Mass Transit District</td>
<td style="text-align: left;">994 754</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 25em;">Transit Authority of Central Kentucky, dba: TACK</td>
<td style="text-align: left;">98 435</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 25em;">City of Long Beach</td>
<td style="text-align: left;">97 523</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>2. MTA NYC Average trip length</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"NY"</span>, <span class="fu">grepl</span>(<span class="st">"MTA"</span>, Agency)) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Total Miles</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(MILES, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Total Trips</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(UPT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Avg Miles/Trip</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(MILES)<span class="sc">/</span><span class="fu">sum</span>(UPT), <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"MTA New York City Transit Metrics"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>MTA New York City Transit Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Miles</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Trips</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Avg Miles/Trip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">13 154 350 011</td>
<td style="text-align: left;">2 907 250 428</td>
<td style="text-align: right;">4.52</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>3. NYC Agency with Longest Average Trips</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"NY"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Agency) <span class="sc">|&gt;</span>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Avg Trip Length (miles)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(MILES)<span class="sc">/</span><span class="fu">sum</span>(UPT), <span class="dv">2</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Avg Trip Length (miles)</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Avg Trip Length (miles)</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 3 NYC Agencies by Average Trip Length"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 3 NYC Agencies by Average Trip Length</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Avg Trip Length (miles)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em;">Hampton Jitney, Inc.</td>
<td style="text-align: right;">92.45</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">Adirondack Transit Lines, Inc., dba: Adirondack Trailways</td>
<td style="text-align: right;">85.64</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em;">Monsey New Square Trails Corporation</td>
<td style="text-align: right;">41.50</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>4. State with Lowest Transit Mileage</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State) <span class="sc">|&gt;</span>  </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Total Miles</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(MILES, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">Total Miles</span><span class="st">`</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"States with Lowest Transit Mileage"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>States with Lowest Transit Mileage</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total Miles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">WA</td>
<td style="text-align: left;">1 059 910 614</td>
</tr>
<tr class="even">
<td style="text-align: left;">FL</td>
<td style="text-align: left;">1 103 199 393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IL</td>
<td style="text-align: left;">1 142 696 394</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>5. Missing States Analysis</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>present_states <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(NTD_SERVICE<span class="sc">$</span>State))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>missing <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state.abb, present_states)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(missing) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">State Code</span><span class="st">`</span> <span class="ot">=</span> missing,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">State Name</span><span class="st">`</span> <span class="ot">=</span> state.name[<span class="fu">match</span>(missing, state.abb)]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"States Missing from Transit Data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"8em"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"All 50 states are represented in the dataset."</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>States Missing from Transit Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State.Code</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">State.Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 8em;">AZ</td>
<td style="text-align: left;">Arizona</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">AR</td>
<td style="text-align: left;">Arkansas</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">CA</td>
<td style="text-align: left;">California</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">CO</td>
<td style="text-align: left;">Colorado</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">HI</td>
<td style="text-align: left;">Hawaii</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">IA</td>
<td style="text-align: left;">Iowa</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">KS</td>
<td style="text-align: left;">Kansas</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">LA</td>
<td style="text-align: left;">Louisiana</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">MO</td>
<td style="text-align: left;">Missouri</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">MT</td>
<td style="text-align: left;">Montana</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">NE</td>
<td style="text-align: left;">Nebraska</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">NV</td>
<td style="text-align: left;">Nevada</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">NM</td>
<td style="text-align: left;">New Mexico</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">ND</td>
<td style="text-align: left;">North Dakota</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">OK</td>
<td style="text-align: left;">Oklahoma</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">SD</td>
<td style="text-align: left;">South Dakota</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">TX</td>
<td style="text-align: left;">Texas</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 8em;">UT</td>
<td style="text-align: left;">Utah</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 8em;">WY</td>
<td style="text-align: left;">Wyoming</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="task-5-calculating-total-emissions" class="level2">
<h2 class="anchored" data-anchor-id="task-5-calculating-total-emissions"><strong>Task-5: Calculating Total Emissions</strong></h2>
<section id="analysis-steps" class="level3">
<h3 class="anchored" data-anchor-id="analysis-steps">Analysis Steps</h3>
<ol type="1">
<li><strong>Clean Agency Names</strong>: Standardize agency names by removing alternate business names</li>
<li><strong>Combine Datasets</strong>:
<ul>
<li>Join transit service data with energy consumption data</li>
<li>Merge with state-level emission factors</li>
</ul></li>
<li><strong>Reshape Data</strong>: Convert fuel columns to long format for analysis</li>
<li><strong>Define Emission Factors</strong>: Create mapping of emission factors by fuel type</li>
<li><strong>Calculate Emissions</strong>:
<ul>
<li>For electric: Use state-level CO₂ per MWh</li>
<li>For combustion fuels: Apply fuel-specific emission factors</li>
</ul></li>
<li><strong>Summarize Results</strong>:
<ul>
<li>Create agency-level emission totals</li>
<li>Generate detailed fuel breakdowns</li>
</ul></li>
</ol>
<p>Emission calculation process</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Clean agency names</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>NTD_SERVICE <span class="ot">&lt;-</span> NTD_SERVICE <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AgencyClean =</span> <span class="fu">gsub</span>(<span class="st">", dba:.*$"</span>, <span class="st">""</span>, Agency))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Join datasets</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> NTD_ENERGY <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(NTD_SERVICE <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, State, AgencyClean, City, UPT, MILES),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"NTD ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(EIA_SEP_REPORT <span class="sc">%&gt;%</span> <span class="fu">select</span>(abbreviation, CO2_MWh),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"State"</span> <span class="ot">=</span> <span class="st">"abbreviation"</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3-4: Pivot and add emission factors</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>emission_factors <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fuel_Type =</span> <span class="fu">c</span>(<span class="st">"Bio-Diesel"</span>, <span class="st">"Bunker Fuel"</span>, <span class="st">"C Natural Gas"</span>, <span class="st">"Diesel Fuel"</span>, </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Gasoline"</span>, <span class="st">"Kerosene"</span>, <span class="st">"Liquified Nat Gas"</span>, <span class="st">"Liquified Petroleum Gas"</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Emission_Factor =</span> <span class="fu">c</span>(<span class="fl">22.45</span>, <span class="fl">26.00</span>, <span class="fl">120.85</span>, <span class="fl">22.45</span>, </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">18.73</span>, <span class="fl">21.78</span>, <span class="fl">120.85</span>, <span class="fl">12.68</span>),</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unit =</span> <span class="fu">c</span>(<span class="st">"gallon"</span>, <span class="st">"gallon"</span>, <span class="st">"thousand cubic feet"</span>, <span class="st">"gallon"</span>, </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">"gallon"</span>, <span class="st">"gallon"</span>, <span class="st">"thousand cubic feet"</span>, <span class="st">"gallon"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>emissions_calculated <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Bio-Diesel</span><span class="st">`</span>, <span class="st">`</span><span class="at">Bunker Fuel</span><span class="st">`</span>, <span class="st">`</span><span class="at">C Natural Gas</span><span class="st">`</span>, <span class="st">`</span><span class="at">Diesel Fuel</span><span class="st">`</span>, </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Electric Battery</span><span class="st">`</span>, <span class="st">`</span><span class="at">Electric Propulsion</span><span class="st">`</span>, Ethanol, Methonal, </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>             Gasoline, Hydrogen, Kerosene, <span class="st">`</span><span class="at">Liquified Nat Gas</span><span class="st">`</span>, <span class="st">`</span><span class="at">Liquified Petroleum Gas</span><span class="st">`</span>),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Fuel_Type"</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Fuel_Amount"</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fuel_Amount <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(emission_factors, <span class="at">by =</span> <span class="st">"Fuel_Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">CO2_Emissions =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>      Fuel_Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Electric Battery"</span>, <span class="st">"Electric Propulsion"</span>) <span class="sc">~</span> </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>        Fuel_Amount <span class="sc">/</span> <span class="dv">1000</span> <span class="sc">*</span> CO2_MWh,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(Emission_Factor) <span class="sc">~</span> Fuel_Amount <span class="sc">*</span> Emission_Factor,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="agency-level-emission" class="level3">
<h3 class="anchored" data-anchor-id="agency-level-emission">Agency level emission</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>agency_mode_emissions <span class="ot">&lt;-</span> emissions_calculated <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, Mode, State) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total CO₂ Emissions (lbs)</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(CO2_Emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Per Passenger Mile (lbs)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(CO2_Emissions)<span class="sc">/</span><span class="fu">sum</span>(MILES), <span class="dv">4</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>agency_mode_emissions <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Total CO₂ Emissions (lbs)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 10 Agencies by Total CO₂ Emissions"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 Agencies by Total CO₂ Emissions</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">NTD ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mode</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total CO₂ Emissions (lbs)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Per Passenger Mile (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">57</td>
<td style="text-align: left; width: 20em;">Central Oregon Intergovernmental Council</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">OR</td>
<td style="text-align: left;">997 635</td>
<td style="text-align: right;">0.1417</td>
</tr>
<tr class="even">
<td style="text-align: right;">80002</td>
<td style="text-align: left; width: 20em;">City of Sioux Falls</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">991 885</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">46</td>
<td style="text-align: left; width: 20em;">City of Wilsonville</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">OR</td>
<td style="text-align: left;">991 762</td>
<td style="text-align: right;">0.4108</td>
</tr>
<tr class="even">
<td style="text-align: right;">60111</td>
<td style="text-align: left; width: 20em;">Rio Metro Regional Transit District</td>
<td style="text-align: left;">Commuter Bus</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">981 357</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10053</td>
<td style="text-align: left; width: 20em;">Cape Ann Transportation Authority</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">MA</td>
<td style="text-align: left;">971 019</td>
<td style="text-align: right;">1.8696</td>
</tr>
<tr class="even">
<td style="text-align: right;">90134</td>
<td style="text-align: left; width: 20em;">Peninsula Corridor Joint Powers Board</td>
<td style="text-align: left;">Commuter Rail</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">97 335 028</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40044</td>
<td style="text-align: left; width: 20em;">City of Montgomery</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">969 352</td>
<td style="text-align: right;">0.5069</td>
</tr>
<tr class="even">
<td style="text-align: right;">10053</td>
<td style="text-align: left; width: 20em;">Cape Ann Transportation Authority</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">MA</td>
<td style="text-align: left;">969 005</td>
<td style="text-align: right;">0.9329</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20010</td>
<td style="text-align: left; width: 20em;">Dutchess County</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">NY</td>
<td style="text-align: left;">964 879</td>
<td style="text-align: right;">0.2425</td>
</tr>
<tr class="even">
<td style="text-align: right;">30034</td>
<td style="text-align: left; width: 20em;">Maryland Transit Administration</td>
<td style="text-align: left;">Commuter Rail</td>
<td style="text-align: left;">MD</td>
<td style="text-align: left;">96 061 227</td>
<td style="text-align: right;">0.1399</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="detailed-fuel-breakdown" class="level3">
<h3 class="anchored" data-anchor-id="detailed-fuel-breakdown">Detailed Fuel Breakdown</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>detailed_emissions <span class="ot">&lt;-</span> emissions_calculated <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, Mode, Fuel_Type) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fuel Used</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(Fuel_Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CO₂ Emissions (lbs)</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(CO2_Emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>detailed_emissions <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">CO₂ Emissions (lbs)</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">CO₂ Emissions (lbs)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 10 Fuel Types by CO₂ Emissions"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 Fuel Types by CO₂ Emissions</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mode</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Fuel_Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Fuel Used</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CO₂ Emissions (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 20em;">Lakeland Area Mass Transit District</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Gasoline</td>
<td style="text-align: left;">53 309</td>
<td style="text-align: left;">998 478</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">Beaver County Transit Authority</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Diesel Fuel</td>
<td style="text-align: left;">44 413</td>
<td style="text-align: left;">997 072</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em;">City of Lawrence</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Gasoline</td>
<td style="text-align: left;">53 226</td>
<td style="text-align: left;">996 923</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">Montgomery County, Maryland</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Electric Battery</td>
<td style="text-align: left;">178</td>
<td style="text-align: left;">99</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em;">Mass Transportation Authority</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Diesel Fuel</td>
<td style="text-align: left;">43 867</td>
<td style="text-align: left;">984 814</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">Rio Metro Regional Transit District</td>
<td style="text-align: left;">Commuter Bus</td>
<td style="text-align: left;">Diesel Fuel</td>
<td style="text-align: left;">43 713</td>
<td style="text-align: left;">981 357</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em;">Cape Ann Transportation Authority</td>
<td style="text-align: left;">Demand Response</td>
<td style="text-align: left;">Gasoline</td>
<td style="text-align: left;">51 843</td>
<td style="text-align: left;">971 019</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">City of Winston Salem</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Gasoline</td>
<td style="text-align: left;">5 217</td>
<td style="text-align: left;">97 714</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 20em;">Greater Peoria Mass Transit District</td>
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">Electric Battery</td>
<td style="text-align: left;">187 119</td>
<td style="text-align: left;">97 676</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 20em;">Peninsula Corridor Joint Powers Board</td>
<td style="text-align: left;">Commuter Rail</td>
<td style="text-align: left;">Diesel Fuel</td>
<td style="text-align: left;">4 335 636</td>
<td style="text-align: left;">97 335 028</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="state-level-emission-intensity" class="level3">
<h3 class="anchored" data-anchor-id="state-level-emission-intensity">State-Level Emission Intensity</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>state_emissions <span class="ot">&lt;-</span> emissions_calculated <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total CO₂ (tons)</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="fu">sum</span>(CO2_Emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2000</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Per Capita (lbs)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(CO2_Emissions)<span class="sc">/</span><span class="fu">sum</span>(UPT), <span class="dv">2</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>state_emissions <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Total CO₂ (tons)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 10 States by Total Transit Emissions"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 States by Total Transit Emissions</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Total CO₂ (tons)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Per Capita (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MN</td>
<td style="text-align: left;">99 932</td>
<td style="text-align: right;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">IN</td>
<td style="text-align: left;">91 283</td>
<td style="text-align: right;">2.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">9 287 863</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">WV</td>
<td style="text-align: left;">9 184</td>
<td style="text-align: right;">2.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CT</td>
<td style="text-align: left;">83 776</td>
<td style="text-align: right;">1.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">NJ</td>
<td style="text-align: left;">708 419</td>
<td style="text-align: right;">0.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OR</td>
<td style="text-align: left;">69 964</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">WI</td>
<td style="text-align: left;">65 624</td>
<td style="text-align: right;">1.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PA</td>
<td style="text-align: left;">595 885</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">TN</td>
<td style="text-align: left;">56 948</td>
<td style="text-align: right;">1.64</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="task-6-normalizing-emissions-to-transit-usage" class="level2">
<h2 class="anchored" data-anchor-id="task-6-normalizing-emissions-to-transit-usage"><strong>Task-6: Normalizing Emissions to Transit Usage</strong></h2>
<section id="analysis-overview" class="level3">
<h3 class="anchored" data-anchor-id="analysis-overview">Analysis Overview</h3>
<p>This analysis evaluates transit agency environmental efficiency by normalizing CO₂ emissions to service usage metrics. We examine:</p>
<ol type="1">
<li><strong>Emissions per passenger trip</strong> (CO₂/UPT) - Environmental impact per boarding</li>
<li><strong>Emissions per passenger mile</strong> (CO₂/mile) - Efficiency during travel</li>
<li><strong>Size-based comparisons</strong> - Groups agencies by annual ridership:
<ul>
<li>Small (&lt;1M trips)</li>
<li>Medium (1-10M trips)</li>
<li>Large (&gt;10M trips)</li>
</ul></li>
</ol>
<p><em>Data preparation</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>agency_emissions <span class="ot">&lt;-</span> emissions_calculated <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_CO2_Emissions =</span> <span class="fu">sum</span>(CO2_Emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>agency_efficiency <span class="ot">&lt;-</span> agency_emissions <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(NTD_SERVICE <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, UPT, MILES), <span class="at">by =</span> <span class="st">"NTD ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(UPT) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(MILES) <span class="sc">&amp;</span> UPT <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> MILES <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">CO2_per_UPT =</span> Total_CO2_Emissions <span class="sc">/</span> UPT,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">CO2_per_Mile =</span> Total_CO2_Emissions <span class="sc">/</span> MILES,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Size_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      UPT <span class="sc">&lt;</span> <span class="dv">1000000</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>      UPT <span class="sc">&lt;</span> <span class="dv">10000000</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="efficiency-metrics" class="level3">
<h3 class="anchored" data-anchor-id="efficiency-metrics"><em>Efficiency Metrics</em></h3>
<section id="emissions-per-passenger-trip" class="level4">
<h4 class="anchored" data-anchor-id="emissions-per-passenger-trip"><em>Emissions per Passenger Trip</em></h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>most_efficient_upt <span class="ot">&lt;-</span> agency_efficiency <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.infinite</span>(CO2_per_UPT) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(CO2_per_UPT)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CO2_per_UPT) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Size_Category, <span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Annual Trips</span><span class="st">`</span> <span class="ot">=</span> UPT, <span class="st">`</span><span class="at">Total CO₂ (lbs)</span><span class="st">`</span> <span class="ot">=</span> Total_CO2_Emissions,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CO₂ per Trip (lbs)</span><span class="st">`</span> <span class="ot">=</span> CO2_per_UPT)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(most_efficient_upt, <span class="at">caption =</span> <span class="st">"Top 5 Most Efficient Agencies by CO₂ per Passenger Trip"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Most Efficient Agencies by CO₂ per Passenger Trip</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Size_Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Annual Trips</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total CO₂ (lbs)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CO₂ per Trip (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Tri-County Metropolitan Transportation District of Oregon</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">57442650</td>
<td style="text-align: right;">2.784223e+07</td>
<td style="text-align: right;">0.4846961</td>
</tr>
<tr class="even">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">MTA New York City Transit</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">2632003044</td>
<td style="text-align: right;">2.124131e+09</td>
<td style="text-align: right;">0.8070399</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Port Authority Trans-Hudson Corporation</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">55108860</td>
<td style="text-align: right;">5.118775e+07</td>
<td style="text-align: right;">0.9288480</td>
</tr>
<tr class="even">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Chicago Transit Authority</td>
<td style="text-align: left;">IL</td>
<td style="text-align: right;">279146501</td>
<td style="text-align: right;">4.823191e+08</td>
<td style="text-align: right;">1.7278350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Southeastern Pennsylvania Transportation Authority</td>
<td style="text-align: left;">PA</td>
<td style="text-align: right;">197264920</td>
<td style="text-align: right;">4.606526e+08</td>
<td style="text-align: right;">2.3351980</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">City of Seattle</td>
<td style="text-align: left;">WA</td>
<td style="text-align: right;">2134977</td>
<td style="text-align: right;">1.476457e+05</td>
<td style="text-align: right;">0.0691556</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">City of Portland</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">3692695</td>
<td style="text-align: right;">9.835201e+05</td>
<td style="text-align: right;">0.2663421</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">University of Georgia</td>
<td style="text-align: left;">GA</td>
<td style="text-align: right;">2941019</td>
<td style="text-align: right;">2.279450e+06</td>
<td style="text-align: right;">0.7750546</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">West Virginia University</td>
<td style="text-align: left;">WV</td>
<td style="text-align: right;">1600303</td>
<td style="text-align: right;">1.864844e+06</td>
<td style="text-align: right;">1.1653067</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">North Carolina State University</td>
<td style="text-align: left;">NC</td>
<td style="text-align: right;">2560095</td>
<td style="text-align: right;">3.504894e+06</td>
<td style="text-align: right;">1.3690484</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">City of Fort Lauderdale</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">218791</td>
<td style="text-align: right;">5.423671e+05</td>
<td style="text-align: right;">2.4789280</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">City of Fairfax</td>
<td style="text-align: left;">VA</td>
<td style="text-align: right;">845194</td>
<td style="text-align: right;">2.340906e+06</td>
<td style="text-align: right;">2.7696676</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Mecklenburg County</td>
<td style="text-align: left;">NC</td>
<td style="text-align: right;">349575</td>
<td style="text-align: right;">1.128951e+06</td>
<td style="text-align: right;">3.2294951</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Barnegat Bay Decoy &amp; Baymen's Museum</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">7343</td>
<td style="text-align: right;">2.474233e+04</td>
<td style="text-align: right;">3.3695125</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Muncie Indiana Transit System</td>
<td style="text-align: left;">IN</td>
<td style="text-align: right;">919115</td>
<td style="text-align: right;">3.739877e+06</td>
<td style="text-align: right;">4.0689984</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(agency_efficiency, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="sc">~</span>Size_Category, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="sc">~</span>CO2_per_UPT, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>Size_Category,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"box"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">hoverinfo =</span> <span class="st">"y"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Agency:"</span>, <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, <span class="st">"&lt;br&gt;State:"</span>, State))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> fig1 <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"CO₂ Emissions per Passenger Trip by Agency Size"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"CO₂ (lbs) per Trip"</span>, <span class="at">type =</span> <span class="st">"log"</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Agency Size Category"</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ffc4f25ab85bf888dc62" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ffc4f25ab85bf888dc62">{"x":{"visdat":{"10c516d4c6ca4":["function () ","plotlyVisDat"]},"cur_data":"10c516d4c6ca4","attrs":{"10c516d4c6ca4":{"x":{},"y":{},"hoverinfo":"y","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"CO₂ Emissions per Passenger Trip by Agency Size","yaxis":{"domain":[0,1],"automargin":true,"title":"CO₂ (lbs) per Trip","type":"log"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Agency Size Category","type":"category","categoryorder":"array","categoryarray":["Large","Medium","Small"]},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large"],"y":[2.6409688095536534,0.48469612349012448,18.870563401291335,3.5828806974495335,4.2989088473491908,3.4557643333036729,3.4512930644717779,4.0579777113612465,10.342420541267847,0.80703989716358393,2.3707087321826181,5.6117961106775969,6.1468924889133332,7.4356257810289828,0.92884796996345054,5.3105580055591108,3.7924001658785849,20.534592969916702,2.3351979583850997,4.6899623828746515,3.068934909619522,5.5190836866007817,14.360117750267079,5.0133639964123846,11.454450804202089,5.4169163461677829,4.8954543506400956,11.491998052125085,22.065350239056759,14.887957945040448,3.3557163158968439,4.9157540736336101,16.918573977498472,27.137965461992327,2.9025667968758597,1.7278349950372476],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: King County <br>State: WA","Agency: Tri-County Metropolitan Transportation District of Oregon <br>State: OR","Agency: Washington State Ferries <br>State: WA","Agency: Central Puget Sound Regional Transit Authority <br>State: WA","Agency: Rhode Island Public Transit Authority <br>State: RI","Agency: Massachusetts Bay Transportation Authority <br>State: MA","Agency: Connecticut Department of Transportation - CTTRANSIT - Hartford Division <br>State: CT","Agency: Capital District Transportation Authority <br>State: NY","Agency: Niagara Frontier Transportation Authority <br>State: NY","Agency: MTA New York City Transit <br>State: NY","Agency: Westchester County <br>State: NY","Agency: Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad <br>State: NY","Agency: New Jersey Transit Corporation <br>State: NJ","Agency: New York City Department of Transportation <br>State: NY","Agency: Port Authority Trans-Hudson Corporation <br>State: NY","Agency: MTA Long Island Rail Road <br>State: NY","Agency: MTA Bus Company <br>State: NY","Agency: County of Nassau <br>State: NY","Agency: Southeastern Pennsylvania Transportation Authority <br>State: PA","Agency: Pittsburgh Regional Transit <br>State: PA","Agency: Washington Metropolitan Area Transit Authority <br>State: DC","Agency: Maryland Transit Administration <br>State: MD","Agency: Montgomery County, Maryland <br>State: MD","Agency: City of Charlotte North Carolina <br>State: NC","Agency: Metropolitan Atlanta Rapid Transit Authority <br>State: GA","Agency: Pinellas Suncoast Transit Authority <br>State: FL","Agency: Broward County Board of County Commissioners <br>State: FL","Agency: County of Miami-Dade <br>State: FL","Agency: Central Florida Regional Transportation Authority <br>State: FL","Agency: Hillsborough Area Regional Transit Authority <br>State: FL","Agency: Milwaukee County <br>State: WI","Agency: Southwest Ohio Regional Transit Authority <br>State: OH","Agency: The Greater Cleveland Regional Transit Authority <br>State: OH","Agency: Central Ohio Transit Authority <br>State: OH","Agency: Metro Transit <br>State: MN","Agency: Chicago Transit Authority <br>State: IL"],"type":"box","name":"Large","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium"],"y":[3.9559065746082487,20.19689818785983,4.6525686100059067,2.7197694319978112,47.887262656928762,5.5807004573945678,7.5257761996138273,4.8710047537891175,17.196031649453786,3.4078887366915311,0.069155645236459215,4.9305195385176335,17.602810202642328,7.8122472485337271,5.517207849148007,0.26634208349186705,3.7634986809090836,4.1427236306800621,3.8530128065148004,5.2215930635494905,2.7150271771935603,7.607670728950426,4.4066121971992791,2.2204529297471693,3.4165761410156423,2.616265619315183,4.6021196313528989,4.8590261160481596,6.5150457426353645,4.2323609677884937,20.144351008117578,4.5323997006792434,14.767375036367184,16.232179571633065,3.570662662741245,8.5091706791061306,2.424894660396308,3.4775753915346272,15.564509169160798,11.851706388460427,3.231850418580879,1.905769928424645,6.8662301018060612,55.668572593137419,13.516658703654521,8.4798758567238721,22.742728746642204,7.8163022060623,30.458512931167206,34.780066232748958,12.937731898293523,6.8143179533280174,16.020227561368547,3.3152861163663276,25.508023017902815,7.9313728185620889,37.664181734773976,8.1354752798670145,11.82651452231924,1.501836687141592,2.6502991503507483,1.1653066638005427,3.3295451809181582,2.234896774572587,5.8609541720948224,21.233454826954013,5.7163516199808884,5.5783963587735954,10.469854838721117,5.546741035452933,3.8229369847801946,22.096781458561491,3.1532535172587171,6.9671088237111363,12.861705597550081,6.083122020871488,8.9302687253383581,4.3779413047386555,4.9910035090954281,10.408796553318792,3.6141285554119853,8.2535239123104045,11.80612403664394,11.188161110481293,31.509954343934396,49.664901907936574,6.9213613577123683,3.7579245054083001,2.956826155280015,6.5381033724719391,15.198962170911381,9.1690925454451122,2.5987758790163955,5.7381755175966971,2.3779062810229585,3.0034694671514606,2.2518269010824969,7.3325108203138942,4.7923810524900263,21.406436449327746,7.2491237624290497,1.3690484142190036,31.458470053990705,0.77505463548518383,22.223052607203673,3.9656321045592509,2.5376451835175757,5.7829834151534527,30.65094769131731,36.513054128187797,4.4744584415319872,7.7932933973099363,4.1062639665601539,4.3902544120785292,10.571479483353665,34.107737022057449,21.871992145024105,5.1075439691510081,2.99309888933238,4.7717637165598603,4.5385882163884217,3.6478184829211129,6.4967688769437117,12.687147599976704,35.364667749556993,7.941677729260908,32.277705901521614,25.362424570026807,1.722356500666153,10.889320103796349],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: Spokane Transit Authority <br>State: WA","Agency: Pierce County Transportation Benefit Area Authority <br>State: WA","Agency: City of Everett <br>State: WA","Agency: Lane Transit District <br>State: OR","Agency: Valley Regional Transit <br>State: ID","Agency: Municipality of Anchorage <br>State: AK","Agency: Ben Franklin Transit <br>State: WA","Agency: Intercity Transit <br>State: WA","Agency: Kitsap County Public Transportation Benefit Area Authority <br>State: WA","Agency: Whatcom Transportation Authority <br>State: WA","Agency: City of Seattle <br>State: WA","Agency: Clark County Public Transportation Benefit Area Authority <br>State: WA","Agency: Salem Area Mass Transit District <br>State: OR","Agency: Snohomish County Public Transportation Benefit Area Corporation <br>State: WA","Agency: Chelan Douglas PTBA <br>State: WA","Agency: City of Portland <br>State: OR","Agency: Brockton Area Transit Authority <br>State: MA","Agency: Southeastern Regional Transit Authority <br>State: MA","Agency: Pioneer Valley Transit Authority <br>State: MA","Agency: Merrimack Valley Regional Transit Authority <br>State: MA","Agency: Worcester Regional Transit Authority <br>State: MA","Agency: Greater Portland Transit District <br>State: ME","Agency: Southeast Area Transit District <br>State: CT","Agency: Greater Bridgeport Transit Authority <br>State: CT","Agency: Connecticut Department of Transportation - CTTRANSIT New Haven Division <br>State: CT","Agency: Connecticut Department of Transportation - CTTRANSIT Stamford Division <br>State: CT","Agency: Norwalk Transit District <br>State: CT","Agency: Green Mountain Transit Authority <br>State: VT","Agency: Casco Bay Island Transit District <br>State: ME","Agency: Connecticut Department of Transportation- CTTransit Waterbury- NET <br>State: CT","Agency: Woods Hole, Martha's Vineyard and Nantucket Steamship Authority <br>State: MA","Agency: Broome County <br>State: NY","Agency: Central New York Regional Transportation Authority <br>State: NY","Agency: Suffolk County <br>State: NY","Agency: Port Authority Transit Corporation <br>State: NJ","Agency: County of Rockland <br>State: NY","Agency: Staten Island Rapid Transit Operating Authority <br>State: NY","Agency: Regional Transit Service <br>State: NY","Agency: Academy Lines, Inc. <br>State: NJ","Agency: Hudson Transit Lines, Inc. <br>State: NJ","Agency: Tompkins Consolidated Area Transit <br>State: NY","Agency: Orange-Newark-Elizabeth, Inc. <br>State: NJ","Agency: Port Imperial Ferry Corporation <br>State: NJ","Agency: SeaStreak, LLC <br>State: NJ","Agency: New York City Economic Development Corporation <br>State: NY","Agency: Kanawha Valley Regional Transportation Authority <br>State: WV","Agency: Greater Richmond Transit Company <br>State: VA","Agency: Greater Roanoke Transit Company <br>State: VA","Agency: Lehigh and Northampton Transportation Authority <br>State: PA","Agency: Erie Metropolitan Transit Authority <br>State: PA","Agency: Centre Area Transportation Authority <br>State: PA","Agency: Fairfax County, VA <br>State: VA","Agency: Potomac and Rappahannock Transportation Commission <br>State: VA","Agency: City of Alexandria <br>State: VA","Agency: Virginia Railway Express <br>State: VA","Agency: Delaware Transit Corporation <br>State: DE","Agency: Arlington County, Virginia <br>State: VA","Agency: Transportation District Commission of Hampton Roads <br>State: VA","Agency: Prince George's County, Maryland <br>State: MD","Agency: Town of Blacksburg <br>State: VA","Agency: City of Harrisonburg <br>State: VA","Agency: West Virginia University <br>State: WV","Agency: District Department of Transportation <br>State: DC","Agency: City of Baltimore <br>State: MD","Agency: South Central Transit Authority <br>State: PA","Agency: Susquehanna Regional Transportation Authority <br>State: PA","Agency: Chattanooga Area Regional Transportation Authority <br>State: TN","Agency: City of Knoxville <br>State: TN","Agency: City of Memphis <br>State: TN","Agency: Metropolitan Transit Authority <br>State: TN","Agency: City of Asheville <br>State: NC","Agency: City of Raleigh <br>State: NC","Agency: City of Fayetteville <br>State: NC","Agency: City of Winston Salem <br>State: NC","Agency: Lexington Transit Authority <br>State: KY","Agency: Transit Authority of River City <br>State: KY","Agency: Transit Authority of Northern Kentucky <br>State: KY","Agency: Chatham Area Transit Authority <br>State: GA","Agency: Manatee County Board of County Commissioners <br>State: FL","Agency: Lee County <br>State: FL","Agency: City of Gainesville, FL <br>State: FL","Agency: County of Volusia <br>State: FL","Agency: City of Tallahassee <br>State: FL","Agency: Board of County Commissioners, Palm Beach County <br>State: FL","Agency: Jacksonville Transportation Authority <br>State: FL","Agency: Birmingham-Jefferson County Transit Authority <br>State: AL","Agency: Sarasota County <br>State: FL","Agency: Athens-Clarke County Unified Government <br>State: GA","Agency: Town of Chapel Hill <br>State: NC","Agency: Brevard Board of County Commissioners <br>State: FL","Agency: South Florida Regional Transportation Authority <br>State: FL","Agency: Metropolitan Bus Authority <br>State: PR","Agency: City of Durham <br>State: NC","Agency: City of Greensboro <br>State: NC","Agency: Alternativa de Transporte Integrado <br>State: PR","Agency: Indian River County <br>State: FL","Agency: Puerto Rico Highway and Transportation Authority – Público <br>State: PR","Agency: Research Triangle Regional Public Transportation Authority <br>State: NC","Agency: Charleston Area Regional Transportation Authority <br>State: SC","Agency: Gwinnett County Board of Commissioners <br>State: GA","Agency: Central Midlands Regional Transportation Authority <br>State: SC","Agency: North Carolina State University <br>State: NC","Agency: Puerto Rico Maritime Transport Authority <br>State: PR","Agency: University of Georgia <br>State: GA","Agency: Central Florida Commuter Rail <br>State: FL","Agency: City of Kenosha <br>State: WI","Agency: City of Madison <br>State: WI","Agency: City of Racine, Wisconsin <br>State: WI","Agency: METRO Regional Transit Authority <br>State: OH","Agency: Stark Area Regional Transit Authority <br>State: OH","Agency: Greater Dayton Regional Transit Authority <br>State: OH","Agency: Toledo Area Regional Transit Authority <br>State: OH","Agency: Western Reserve Transit Authority <br>State: OH","Agency: Duluth Transit Authority <br>State: MN","Agency: Suburban Mobility Authority for Regional Transportation <br>State: MI","Agency: Mass Transportation Authority <br>State: MI","Agency: Interurban Transit Partnership <br>State: MI","Agency: Central County Transportation Authority <br>State: MI","Agency: Capital Area Transportation Authority <br>State: MI","Agency: Ann Arbor Area Transportation Authority <br>State: MI","Agency: Fort Wayne Public Transportation Corporation <br>State: IN","Agency: Bloomington-Normal Public Transit System <br>State: IL","Agency: Indianapolis and Marion County Public Transportation <br>State: IN","Agency: Greater Lafayette Public Transportation Corporation <br>State: IN","Agency: South Bend Public Transportation Corporation <br>State: IN","Agency: Greater Peoria Mass Transit District <br>State: IL","Agency: Rock Island County Metropolitan Mass Transit District <br>State: IL","Agency: Springfield Mass Transit District <br>State: IL","Agency: Champaign-Urbana Mass Transit District <br>State: IL","Agency: Northern Indiana Commuter Transportation District <br>State: IN"],"type":"box","name":"Medium","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small"],"y":[7.0814967427490796,7.8867612916842544,8.9610159470953263,36.129836566957849,96.946169388823336,13.570823650165201,24.277828094710983,6.2653466629823926,8.3918756832182702,13.454534980683166,6.6753323600517982,6.823772011357665,20.2002903905293,15.345332964624431,17.550668456737519,24.193535626511569,8.8860489835185028,10.757651201348571,8.1576460787800276,10.209871798095667,10.245135553967316,27.43677451309285,11.461905870168213,25.267671476724907,10.741754414474462,6.3844975045540036,37.38664803702472,37.744393779597146,13.679576119960123,81.650020102811524,36.927912745725692,13.091358141156446,8.1829044095443084,25.04384824562328,13.313679363793982,7.9316381609875739,13.976741789801377,15.865474798579962,9.8079737645464355,15.514338752794147,4.3427379961493511,14.7215854112393,8.4910610590439397,13.711716517091576,22.549870638238733,19.939669496664646,16.6803030852404,18.482305250250558,27.569091420243801,3.3695124608470657,6.3584297588450811,9.6120628429483848,47.203571875084322,28.470650907862179,40.995879832644114,38.934692102436145,30.661858197939459,33.961618582289312,8.0979824641433567,77.508471044542688,17.97856477199409,17.546690215218426,2.7696675556144505,115.72339571681246,6.5020362197148343,5.1073012264820781,9.5273895047613539,7.1704411565699857,21.878816994071968,36.374276493388685,9.6441630525376336,34.759709482631315,20.977443879484145,18.75722512089073,31.356567460979466,10.505060208109622,44.384532100018298,6.939388742922401,8.2662626105194725,60.956100187847646,7.5212368449603995,10.837341981818845,8.2346913301415707,12.537323932755125,9.4818594960069547,6.07604382270475,8.1753762213893708,6.605791892367562,7.1717509828013339,12.048005541625095,26.569563620950873,27.885244731407031,17.900448299266742,21.101758113049438,15.900626508912215,12.093124173332308,19.03770467750455,39.92908101481472,12.807213384941941,24.848437240885723,21.089829873148911,17.095821315454355,9.7985912275357894,8.2638066516064264,24.265209224361254,21.679859709184953,7.1970980947561936,27.022800936795992,16.724328373939468,3.2294951011943072,30.341100427600065,12.697700198371269,23.285821355438291,23.152711799741411,30.021531647766285,7.0116211664321284,20.053083721964711,2.4789280180629003,5.6284227880540643,4.3683557986944175,5.4191137659548385,10.989185975161446,5.655308795942382,64.337861581647459,12.15332478879839,7.27028826099989,8.0892021771375422,5.4838128722344166,7.221873942700042,9.1383064394407167,4.0689983625552841,8.8393280288392901,4.9637596081966491,10.480414066964849,10.151847041754266,5.0289321158836167],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: City of Yakima <br>State: WA","Agency: City of Longview <br>State: WA","Agency: County of Pierce <br>State: WA","Agency: Rogue Valley Transportation District <br>State: OR","Agency: Alaska Railroad Corporation <br>State: AK","Agency: Skagit Transit <br>State: WA","Agency: City of Wilsonville <br>State: OR","Agency: Central Oregon Intergovernmental Council <br>State: OR","Agency: Ride Connection, Inc. <br>State: OR","Agency: Ada County Highway District <br>State: ID","Agency: Lowell Regional Transit Authority <br>State: MA","Agency: Berkshire Regional Transit Authority <br>State: MA","Agency: Greater Hartford Transit District <br>State: CT","Agency: Valley Transit District <br>State: CT","Agency: Connecticut Department of Transportation - CTTransit New Britain -Dattco. <br>State: CT","Agency: Greater New Haven Transit District <br>State: CT","Agency: Housatonic Area Regional Transit <br>State: CT","Agency: Cape Ann Transportation Authority <br>State: MA","Agency: Montachusett Regional Transit Authority <br>State: MA","Agency: Greater Attleboro-Taunton Regional Transit Authority <br>State: MA","Agency: Cooperative Alliance for Seacoast Transportation <br>State: NH","Agency: City of Nashua <br>State: NH","Agency: Western Maine Transportation Services, Inc. <br>State: ME","Agency: Connecticut Department of Transportation <br>State: CT","Agency: Cape Cod Regional Transit Authority <br>State: MA","Agency: Milford Transit District <br>State: CT","Agency: Northern New England Passenger Rail Authority <br>State: ME","Agency: MetroWest Regional Transit Authority <br>State: MA","Agency: Connecticut Department of Transportation -CTTRANSIT New Britain <br>State: CT","Agency: Rhode Island Department of Transportation <br>State: RI","Agency: Hyannis Harbor Tours, Inc. <br>State: MA","Agency: City of Long Beach <br>State: NY","Agency: Dutchess County <br>State: NY","Agency: Town of Huntington <br>State: NY","Agency: Putnam County <br>State: NY","Agency: Suburban Transit Corporation <br>State: NJ","Agency: Monsey New Square Trails Corporation <br>State: NY","Agency: Rockland Coaches, Inc. <br>State: NJ","Agency: Lakeland Bus Lines, Inc. <br>State: NJ","Agency: Trans-Bridge Lines, Inc. <br>State: PA","Agency: Private Transportation Corporation <br>State: NY","Agency: Adirondack Transit Lines, Inc. <br>State: NY","Agency: Ulster County <br>State: NY","Agency: Bergen County <br>State: NJ","Agency: County of Atlantic <br>State: NJ","Agency: Senior Citizens United Community Services of Camden County, Inc. <br>State: NJ","Agency: Somerset County <br>State: NJ","Agency: Hampton Jitney, Inc. <br>State: NY","Agency: Cape May Lewes Ferry <br>State: DE","Agency: Barnegat Bay Decoy & Baymen's Museum <br>State: NJ","Agency: The Tri-State Transit Authority <br>State: WV","Agency: Greater Lynchburg Transit Company <br>State: VA","Agency: Altoona Metro Transit <br>State: PA","Agency: Cambria County Transit Authority <br>State: PA","Agency: Luzerne County Transportation Authority <br>State: PA","Agency: Beaver County Transit Authority <br>State: PA","Agency: County of Lackawanna Transit System <br>State: PA","Agency: River Valley Transit Authority <br>State: PA","Agency: Ohio Valley Regional Transportation Authority <br>State: WV","Agency: Westmoreland County Transit Authority <br>State: PA","Agency: JAUNT, Inc. <br>State: VA","Agency: Pennsylvania Department of Transportation <br>State: PA","Agency: City of Fairfax <br>State: VA","Agency: Mid Mon Valley Transit Authority <br>State: PA","Agency: Frederick County, Maryland <br>State: MD","Agency: Williamsburg Area Transit Authority <br>State: VA","Agency: Borough of Pottstown <br>State: PA","Agency: Southwestern Pennsylvania Commission <br>State: PA","Agency: Loudoun County <br>State: VA","Agency: County of Fayette <br>State: PA","Agency: County Commissioners of Charles County, MD <br>State: MD","Agency: County of Lebanon Transit Authority <br>State: PA","Agency: The Tri-County Council for the Lower Eastern Shore of Maryland <br>State: MD","Agency: Washington County Transportation Authority <br>State: PA","Agency: Anne Arundel County <br>State: MD","Agency: Transit Management of Central Maryland, Inc. <br>State: MD","Agency: Cape Fear Public Transportation Authority <br>State: NC","Agency: Ms Coast Transportation Authority <br>State: MS","Agency: City of Jackson, MS <br>State: MS","Agency: City of Albany <br>State: GA","Agency: Augusta Richmond County Transit Department <br>State: GA","Agency: Lakeland Area Mass Transit District <br>State: FL","Agency: Escambia County Board of County Commissioners, FL <br>State: FL","Agency: City of Mobile <br>State: AL","Agency: City of Montgomery <br>State: AL","Agency: Greenville Transit Authority <br>State: SC","Agency: Jackson Transit Authority <br>State: TN","Agency: City of Rome <br>State: GA","Agency: City of Huntsville, Alabama <br>State: AL","Agency: Pasco County Board of County Commissioners <br>State: FL","Agency: Cobb County <br>State: GA","Agency: County of Douglas <br>State: GA","Agency: Santee Wateree Regional Transportation Authority <br>State: SC","Agency: Okaloosa County Board of County Commissioners <br>State: FL","Agency: Charlotte County Government <br>State: FL","Agency: Collier County <br>State: FL","Agency: Lake County Board of County Commissioners <br>State: FL","Agency: Regional Transportation Authority <br>State: TN","Agency: Regional Planning Commission of Greater Birmingham <br>State: AL","Agency: Knoxville-Knox County Community Action Committee <br>State: TN","Agency: Western Piedmont Regional Transit Authority <br>State: NC","Agency: Piedmont Authority for Regional Transportation <br>State: NC","Agency: The Transportation Management Association Group <br>State: TN","Agency: Bay County Transportation Planning Organization <br>State: FL","Agency: Transit Authority of Central Kentucky <br>State: KY","Agency: Martin County <br>State: FL","Agency: Tampa Bay Area Regional Transit Authority <br>State: FL","Agency: Wake County <br>State: NC","Agency: Buncombe County <br>State: NC","Agency: Mecklenburg County <br>State: NC","Agency: Spartanburg Regional Health Services, Inc. <br>State: SC","Agency: North Central Alabama Regional Council of Governments <br>State: AL","Agency: Baldwin County Commission <br>State: AL","Agency: First Tennessee Human Resource Agency <br>State: TN","Agency: Audubon Area Community Services, Inc. <br>State: KY","Agency: Board of County Commissioners of St. Lucie County <br>State: FL","Agency: Atlanta-Region Transit Link Authority <br>State: GA","Agency: City of Fort Lauderdale <br>State: FL","Agency: City of Appleton <br>State: WI","Agency: City of Green Bay <br>State: WI","Agency: City of La Crosse <br>State: WI","Agency: Portage Area Regional Transportation Authority <br>State: OH","Agency: City of Moorhead <br>State: MN","Agency: St. Cloud Metropolitan Transit Commission <br>State: MN","Agency: Bay Metropolitan Transit Authority <br>State: MI","Agency: City of Jackson Transportation Authority <br>State: MI","Agency: Saginaw Transit Authority Regional Service <br>State: MI","Agency: City of Evansville <br>State: IN","Agency: Gary Public Transportation Corporation <br>State: IN","Agency: City of Terre Haute <br>State: IN","Agency: Muncie Indiana Transit System <br>State: IN","Agency: Rockford Mass Transit District <br>State: IL","Agency: City of Decatur, Il <br>State: IL","Agency: City of Rochester, Minnesota <br>State: MN","Agency: City of Waukesha <br>State: WI","Agency: City of Eau Claire <br>State: WI"],"type":"box","name":"Small","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Interpretation</strong>: Smaller agencies generally show higher variance in trip efficiency. The most efficient large agencies achieve CO₂/trip rates comparable to medium-sized systems.</p>
</section>
<section id="emissions-per-passenger-mile" class="level4">
<h4 class="anchored" data-anchor-id="emissions-per-passenger-mile"><em>Emissions per Passenger mile</em></h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>most_efficient_mile <span class="ot">&lt;-</span> agency_efficiency <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.infinite</span>(CO2_per_Mile) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(CO2_per_Mile)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CO2_per_Mile) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Size_Category, <span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Annual Miles</span><span class="st">`</span> <span class="ot">=</span> MILES, <span class="st">`</span><span class="at">Total CO₂ (lbs)</span><span class="st">`</span> <span class="ot">=</span> Total_CO2_Emissions,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CO₂ per Mile (lbs)</span><span class="st">`</span> <span class="ot">=</span> CO2_per_Mile)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(most_efficient_mile, <span class="at">caption =</span> <span class="st">"Top 5 Most Efficient Agencies by CO₂ per Passenger Mile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Most Efficient Agencies by CO₂ per Passenger Mile</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Size_Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Annual Miles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total CO₂ (lbs)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CO₂ per Mile (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Tri-County Metropolitan Transportation District of Oregon</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">231430380</td>
<td style="text-align: right;">27842229.8</td>
<td style="text-align: right;">0.1203050</td>
</tr>
<tr class="even">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Port Authority Trans-Hudson Corporation</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">268404831</td>
<td style="text-align: right;">51187752.7</td>
<td style="text-align: right;">0.1907110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">MTA Long Island Rail Road</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">2033685836</td>
<td style="text-align: right;">445214379.6</td>
<td style="text-align: right;">0.2189199</td>
</tr>
<tr class="even">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">MTA New York City Transit</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">9591253658</td>
<td style="text-align: right;">2124131466.0</td>
<td style="text-align: right;">0.2214655</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Large</td>
<td style="text-align: left; width: 20em;">Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">1150894931</td>
<td style="text-align: right;">373999751.2</td>
<td style="text-align: right;">0.3249643</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">City of Seattle</td>
<td style="text-align: left;">WA</td>
<td style="text-align: right;">1921479</td>
<td style="text-align: right;">147645.7</td>
<td style="text-align: right;">0.0768396</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">City of Portland</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">4413873</td>
<td style="text-align: right;">983520.1</td>
<td style="text-align: right;">0.2228247</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">Hudson Transit Lines, Inc.</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">93151932</td>
<td style="text-align: right;">21721677.1</td>
<td style="text-align: right;">0.2331855</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">Northern Indiana Commuter Transportation District</td>
<td style="text-align: left;">IN</td>
<td style="text-align: right;">49941941</td>
<td style="text-align: right;">16626205.9</td>
<td style="text-align: right;">0.3329107</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: left; width: 20em;">Academy Lines, Inc.</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">44972754</td>
<td style="text-align: right;">16563205.9</td>
<td style="text-align: right;">0.3682942</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Adirondack Transit Lines, Inc.</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">31065245</td>
<td style="text-align: right;">5340181.5</td>
<td style="text-align: right;">0.1719021</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Hampton Jitney, Inc.</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">49533110</td>
<td style="text-align: right;">9902874.6</td>
<td style="text-align: right;">0.1999243</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Trans-Bridge Lines, Inc.</td>
<td style="text-align: left;">PA</td>
<td style="text-align: right;">31092890</td>
<td style="text-align: right;">6447774.7</td>
<td style="text-align: right;">0.2073714</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">Southwestern Pennsylvania Commission</td>
<td style="text-align: left;">PA</td>
<td style="text-align: right;">758063</td>
<td style="text-align: right;">158961.5</td>
<td style="text-align: right;">0.2096943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small</td>
<td style="text-align: left; width: 20em;">The Transportation Management Association Group</td>
<td style="text-align: left;">TN</td>
<td style="text-align: right;">3623502</td>
<td style="text-align: right;">772050.6</td>
<td style="text-align: right;">0.2130675</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(agency_efficiency, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>Size_Category, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>CO2_per_Mile, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="sc">~</span>Size_Category,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"box"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"y"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Agency:"</span>, <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, <span class="st">"&lt;br&gt;State:"</span>, State)) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"CO₂ Emissions per Passenger Mile by Agency Size"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"CO₂ (lbs) per Mile"</span>, <span class="at">type =</span> <span class="st">"log"</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Agency Size Category"</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-471906a988fdd2a34d50" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-471906a988fdd2a34d50">{"x":{"visdat":{"10c51381774f3":["function () ","plotlyVisDat"]},"cur_data":"10c51381774f3","attrs":{"10c51381774f3":{"x":{},"y":{},"hoverinfo":"y","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"CO₂ Emissions per Passenger Mile by Agency Size","yaxis":{"domain":[0,1],"automargin":true,"title":"CO₂ (lbs) per Mile","type":"log"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Agency Size Category","type":"category","categoryorder":"array","categoryarray":["Large","Medium","Small"]},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large","Large"],"y":[0.69093409678334972,0.12030499097828037,2.6122981161866861,0.38871598339562269,0.90347074170333785,0.73591370003250334,0.78151151766209759,0.9670031699326882,3.2492994549149485,0.22146546652869262,0.5788401730811612,0.32496428742894512,0.52744583146871005,1.4299280273384614,0.19071099632331132,0.21891993923981873,1.3031675969280421,3.6957298314416049,0.55180570743634993,1.1461456328407873,0.77689361341266794,0.93119893180756352,3.5499362978435101,1.0413394752125045,2.0199074352654445,1.0213327655998727,0.95409369974376168,2.1634270436395298,3.6606950561911855,3.4997878602628134,1.0110724913054954,0.90785503061772199,3.6876841243155578,6.0997641339419957,0.74525410613536547,0.44221966306803168],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: King County <br>State: WA","Agency: Tri-County Metropolitan Transportation District of Oregon <br>State: OR","Agency: Washington State Ferries <br>State: WA","Agency: Central Puget Sound Regional Transit Authority <br>State: WA","Agency: Rhode Island Public Transit Authority <br>State: RI","Agency: Massachusetts Bay Transportation Authority <br>State: MA","Agency: Connecticut Department of Transportation - CTTRANSIT - Hartford Division <br>State: CT","Agency: Capital District Transportation Authority <br>State: NY","Agency: Niagara Frontier Transportation Authority <br>State: NY","Agency: MTA New York City Transit <br>State: NY","Agency: Westchester County <br>State: NY","Agency: Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad <br>State: NY","Agency: New Jersey Transit Corporation <br>State: NJ","Agency: New York City Department of Transportation <br>State: NY","Agency: Port Authority Trans-Hudson Corporation <br>State: NY","Agency: MTA Long Island Rail Road <br>State: NY","Agency: MTA Bus Company <br>State: NY","Agency: County of Nassau <br>State: NY","Agency: Southeastern Pennsylvania Transportation Authority <br>State: PA","Agency: Pittsburgh Regional Transit <br>State: PA","Agency: Washington Metropolitan Area Transit Authority <br>State: DC","Agency: Maryland Transit Administration <br>State: MD","Agency: Montgomery County, Maryland <br>State: MD","Agency: City of Charlotte North Carolina <br>State: NC","Agency: Metropolitan Atlanta Rapid Transit Authority <br>State: GA","Agency: Pinellas Suncoast Transit Authority <br>State: FL","Agency: Broward County Board of County Commissioners <br>State: FL","Agency: County of Miami-Dade <br>State: FL","Agency: Central Florida Regional Transportation Authority <br>State: FL","Agency: Hillsborough Area Regional Transit Authority <br>State: FL","Agency: Milwaukee County <br>State: WI","Agency: Southwest Ohio Regional Transit Authority <br>State: OH","Agency: The Greater Cleveland Regional Transit Authority <br>State: OH","Agency: Central Ohio Transit Authority <br>State: OH","Agency: Metro Transit <br>State: MN","Agency: Chicago Transit Authority <br>State: IL"],"type":"box","name":"Large","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium","Medium"],"y":[0.80314791904181626,3.3987709510256097,1.2585811444241999,0.75356313762206362,11.720888539528751,0.84501124937400962,0.98332490647012227,0.77429623317899343,1.9548989350818533,1.0647241469901254,0.076839617815235031,1.1288355391068992,4.7383571935348803,0.9478378047448105,0.62908741755911457,0.22282473464913918,0.65418160225037847,1.1125386997992217,0.9902729900465157,1.0776794159421019,0.67552574500248219,1.311667420454151,0.7749313729090076,0.77188381281361795,0.81275973569622162,0.51194879982621799,1.2812875438422608,1.1563287569550988,1.8300690288301584,1.2480168435479992,1.9132524296794813,1.2653880352068447,4.6426225709248392,1.9825931107839625,0.41415583602509631,1.3972520432004842,0.41238784480197105,1.1762787468089577,0.36829423210328638,0.23318547059227926,0.68047636574767245,0.79522406686676195,3.1037155422533735,2.8165031143996289,2.6978012861779903,1.7243745655685727,4.5680604141200432,1.3233700315102628,5.9958077198486004,15.001545957571752,5.2048316947682105,1.2834388349649655,0.63051268776481373,1.4469819995839452,0.81846899029211539,1.212730891706342,14.976086156361861,1.5845850480678609,1.6219059797046742,0.80445684555262431,1.2538116038699243,0.64513178742423827,2.2104142542992227,1.4796873792540814,1.1910863417450384,3.3239280240513218,1.7267045009668969,1.8011551980575127,2.0394085287877117,1.2972766476044804,1.0522776104762666,4.8164020998589381,0.76089473725856871,2.0297766822995622,2.6862260945556913,1.6607001905432479,1.5981476792274061,1.9296766304117301,1.0889632288309605,1.6899117477248073,1.0434424957427735,0.95110528059919508,3.0135319085069989,1.8746164531061138,5.721765502678501,9.557006045196129,1.3274709608538493,1.0625555596322582,1.6935861021058154,0.9721281299722434,0.5871829257432285,2.2278465594026247,0.78916853196055126,1.3705483252517994,0.56628535790034462,0.65431582860052551,0.4906628239812601,0.81717129762015983,0.8404162108097325,2.0468403930305517,1.1556682938143819,0.84297792581714215,2.439611735105875,0.64899542575681002,1.3234589907175094,1.2263217547928986,0.7238269941477129,1.4324703447956284,7.2925080089737957,4.9996383648776259,0.69691326723618685,1.0543962420235935,1.2042096560259423,0.95267353550402689,1.1174444095250793,2.2596311575708601,4.8033956582796975,1.2684660526767666,0.99441053636228327,0.94556830243892531,1.0636520018329292,1.5421821760232128,1.2712849606081833,5.3130237950832413,9.4686981384055802,1.4795030008527796,6.5493089724824385,6.6931676905753754,0.99789619570083954,0.33291068823296238],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: Spokane Transit Authority <br>State: WA","Agency: Pierce County Transportation Benefit Area Authority <br>State: WA","Agency: City of Everett <br>State: WA","Agency: Lane Transit District <br>State: OR","Agency: Valley Regional Transit <br>State: ID","Agency: Municipality of Anchorage <br>State: AK","Agency: Ben Franklin Transit <br>State: WA","Agency: Intercity Transit <br>State: WA","Agency: Kitsap County Public Transportation Benefit Area Authority <br>State: WA","Agency: Whatcom Transportation Authority <br>State: WA","Agency: City of Seattle <br>State: WA","Agency: Clark County Public Transportation Benefit Area Authority <br>State: WA","Agency: Salem Area Mass Transit District <br>State: OR","Agency: Snohomish County Public Transportation Benefit Area Corporation <br>State: WA","Agency: Chelan Douglas PTBA <br>State: WA","Agency: City of Portland <br>State: OR","Agency: Brockton Area Transit Authority <br>State: MA","Agency: Southeastern Regional Transit Authority <br>State: MA","Agency: Pioneer Valley Transit Authority <br>State: MA","Agency: Merrimack Valley Regional Transit Authority <br>State: MA","Agency: Worcester Regional Transit Authority <br>State: MA","Agency: Greater Portland Transit District <br>State: ME","Agency: Southeast Area Transit District <br>State: CT","Agency: Greater Bridgeport Transit Authority <br>State: CT","Agency: Connecticut Department of Transportation - CTTRANSIT New Haven Division <br>State: CT","Agency: Connecticut Department of Transportation - CTTRANSIT Stamford Division <br>State: CT","Agency: Norwalk Transit District <br>State: CT","Agency: Green Mountain Transit Authority <br>State: VT","Agency: Casco Bay Island Transit District <br>State: ME","Agency: Connecticut Department of Transportation- CTTransit Waterbury- NET <br>State: CT","Agency: Woods Hole, Martha's Vineyard and Nantucket Steamship Authority <br>State: MA","Agency: Broome County <br>State: NY","Agency: Central New York Regional Transportation Authority <br>State: NY","Agency: Suffolk County <br>State: NY","Agency: Port Authority Transit Corporation <br>State: NJ","Agency: County of Rockland <br>State: NY","Agency: Staten Island Rapid Transit Operating Authority <br>State: NY","Agency: Regional Transit Service <br>State: NY","Agency: Academy Lines, Inc. <br>State: NJ","Agency: Hudson Transit Lines, Inc. <br>State: NJ","Agency: Tompkins Consolidated Area Transit <br>State: NY","Agency: Orange-Newark-Elizabeth, Inc. <br>State: NJ","Agency: Port Imperial Ferry Corporation <br>State: NJ","Agency: SeaStreak, LLC <br>State: NJ","Agency: New York City Economic Development Corporation <br>State: NY","Agency: Kanawha Valley Regional Transportation Authority <br>State: WV","Agency: Greater Richmond Transit Company <br>State: VA","Agency: Greater Roanoke Transit Company <br>State: VA","Agency: Lehigh and Northampton Transportation Authority <br>State: PA","Agency: Erie Metropolitan Transit Authority <br>State: PA","Agency: Centre Area Transportation Authority <br>State: PA","Agency: Fairfax County, VA <br>State: VA","Agency: Potomac and Rappahannock Transportation Commission <br>State: VA","Agency: City of Alexandria <br>State: VA","Agency: Virginia Railway Express <br>State: VA","Agency: Delaware Transit Corporation <br>State: DE","Agency: Arlington County, Virginia <br>State: VA","Agency: Transportation District Commission of Hampton Roads <br>State: VA","Agency: Prince George's County, Maryland <br>State: MD","Agency: Town of Blacksburg <br>State: VA","Agency: City of Harrisonburg <br>State: VA","Agency: West Virginia University <br>State: WV","Agency: District Department of Transportation <br>State: DC","Agency: City of Baltimore <br>State: MD","Agency: South Central Transit Authority <br>State: PA","Agency: Susquehanna Regional Transportation Authority <br>State: PA","Agency: Chattanooga Area Regional Transportation Authority <br>State: TN","Agency: City of Knoxville <br>State: TN","Agency: City of Memphis <br>State: TN","Agency: Metropolitan Transit Authority <br>State: TN","Agency: City of Asheville <br>State: NC","Agency: City of Raleigh <br>State: NC","Agency: City of Fayetteville <br>State: NC","Agency: City of Winston Salem <br>State: NC","Agency: Lexington Transit Authority <br>State: KY","Agency: Transit Authority of River City <br>State: KY","Agency: Transit Authority of Northern Kentucky <br>State: KY","Agency: Chatham Area Transit Authority <br>State: GA","Agency: Manatee County Board of County Commissioners <br>State: FL","Agency: Lee County <br>State: FL","Agency: City of Gainesville, FL <br>State: FL","Agency: County of Volusia <br>State: FL","Agency: City of Tallahassee <br>State: FL","Agency: Board of County Commissioners, Palm Beach County <br>State: FL","Agency: Jacksonville Transportation Authority <br>State: FL","Agency: Birmingham-Jefferson County Transit Authority <br>State: AL","Agency: Sarasota County <br>State: FL","Agency: Athens-Clarke County Unified Government <br>State: GA","Agency: Town of Chapel Hill <br>State: NC","Agency: Brevard Board of County Commissioners <br>State: FL","Agency: South Florida Regional Transportation Authority <br>State: FL","Agency: Metropolitan Bus Authority <br>State: PR","Agency: City of Durham <br>State: NC","Agency: City of Greensboro <br>State: NC","Agency: Alternativa de Transporte Integrado <br>State: PR","Agency: Indian River County <br>State: FL","Agency: Puerto Rico Highway and Transportation Authority – Público <br>State: PR","Agency: Research Triangle Regional Public Transportation Authority <br>State: NC","Agency: Charleston Area Regional Transportation Authority <br>State: SC","Agency: Gwinnett County Board of Commissioners <br>State: GA","Agency: Central Midlands Regional Transportation Authority <br>State: SC","Agency: North Carolina State University <br>State: NC","Agency: Puerto Rico Maritime Transport Authority <br>State: PR","Agency: University of Georgia <br>State: GA","Agency: Central Florida Commuter Rail <br>State: FL","Agency: City of Kenosha <br>State: WI","Agency: City of Madison <br>State: WI","Agency: City of Racine, Wisconsin <br>State: WI","Agency: METRO Regional Transit Authority <br>State: OH","Agency: Stark Area Regional Transit Authority <br>State: OH","Agency: Greater Dayton Regional Transit Authority <br>State: OH","Agency: Toledo Area Regional Transit Authority <br>State: OH","Agency: Western Reserve Transit Authority <br>State: OH","Agency: Duluth Transit Authority <br>State: MN","Agency: Suburban Mobility Authority for Regional Transportation <br>State: MI","Agency: Mass Transportation Authority <br>State: MI","Agency: Interurban Transit Partnership <br>State: MI","Agency: Central County Transportation Authority <br>State: MI","Agency: Capital Area Transportation Authority <br>State: MI","Agency: Ann Arbor Area Transportation Authority <br>State: MI","Agency: Fort Wayne Public Transportation Corporation <br>State: IN","Agency: Bloomington-Normal Public Transit System <br>State: IL","Agency: Indianapolis and Marion County Public Transportation <br>State: IN","Agency: Greater Lafayette Public Transportation Corporation <br>State: IN","Agency: South Bend Public Transportation Corporation <br>State: IN","Agency: Greater Peoria Mass Transit District <br>State: IL","Agency: Rock Island County Metropolitan Mass Transit District <br>State: IL","Agency: Springfield Mass Transit District <br>State: IL","Agency: Champaign-Urbana Mass Transit District <br>State: IL","Agency: Northern Indiana Commuter Transportation District <br>State: IN"],"type":"box","name":"Medium","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small","Small"],"y":[1.3330990564321403,2.0837209179351937,2.2706096147200467,7.465192726158512,0.78247071950551916,1.0937254674770884,3.7248685431851665,0.89521629873400022,1.5395042768482334,0.34641508326463966,1.2662339063335124,1.1391422907317381,2.0887053007824861,2.6959741250562304,1.2754891801328678,3.3784663009532978,1.391264364088993,3.7353194332396948,1.0085186380013949,2.2791393044600383,1.5196893109764862,4.8488825369232478,2.4456642687861492,0.84561482588741288,0.8985540335469101,1.2525990096312885,0.43698581331520847,7.3115980627682466,2.3202052297074065,3.1426208298423126,1.3296954451104861,4.7187630100532232,1.7028074090402838,4.5604928648887268,1.6154569847434506,0.23499114814420238,0.33678895879039461,0.69858059269027806,0.28449591820609116,0.20737135402981197,0.82981441497018293,0.17190212084276174,0.92499205960819775,1.5690444438630087,2.9552947533300142,2.2560538492806481,2.8344702810943603,0.19992434555391334,1.6313072364427863,0.41090659979406785,1.0880634235603301,2.1679992740733161,13.000413486572384,4.8623491137517423,8.4245431939458957,4.9633873132028876,6.2539361169213281,5.7884568527187072,1.4506947872918399,6.323247070355702,1.7748401103922575,0.27385862203204736,0.91509573511590625,10.434932435082807,1.2040659085642327,1.0819065053692416,5.4693254352332259,0.20969432619716305,1.4782103245882658,3.2710602670073561,1.1891208431684339,5.6241525882158507,0.747001291925532,1.7770417769626528,4.0781090301583856,1.8299749968768679,14.874007601722164,0.74897134186092029,3.4395904493143274,11.107075964042723,1.8474074056908742,1.974697254745948,1.4887582248162599,1.9242939188796773,2.0929776984545745,1.1562261874381143,1.4935635467534594,0.6851024458210927,1.558423223880893,2.1862623834788901,5.1674811744827363,4.1657007461725337,2.5957819130569475,2.8709004639256062,1.7723673698414184,1.2113185038092464,2.5479856219152359,1.7183567103543009,0.21751506890216282,1.7426327284123517,2.3018718454102882,0.65033874725827534,0.21306752417964719,1.179075881576007,1.4186299748351696,2.6980098269857735,0.2395945797126402,3.2292121680933477,1.6563289522898275,0.35909747456626512,2.9467747370953172,2.35254944725465,2.1961689893157215,1.4608583759291505,1.5837011979560955,1.4063203623271947,0.61106664941054911,1.0099382529840046,1.3117288438365464,1.3607172656236612,1.8524011882152034,3.6952735789782847,1.5700195205690302,14.432288922645862,1.674046984353577,2.5912055548433384,1.2681807549168986,1.4547412733170177,3.5197201554539044,6.7581358546472989,1.0232455155616391,1.7460571370360727,1.7290321368847559,3.0535515469518675,2.3519837599160689,1.8108928816070007],"hoverinfo":["y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y","y"],"text":["Agency: City of Yakima <br>State: WA","Agency: City of Longview <br>State: WA","Agency: County of Pierce <br>State: WA","Agency: Rogue Valley Transportation District <br>State: OR","Agency: Alaska Railroad Corporation <br>State: AK","Agency: Skagit Transit <br>State: WA","Agency: City of Wilsonville <br>State: OR","Agency: Central Oregon Intergovernmental Council <br>State: OR","Agency: Ride Connection, Inc. <br>State: OR","Agency: Ada County Highway District <br>State: ID","Agency: Lowell Regional Transit Authority <br>State: MA","Agency: Berkshire Regional Transit Authority <br>State: MA","Agency: Greater Hartford Transit District <br>State: CT","Agency: Valley Transit District <br>State: CT","Agency: Connecticut Department of Transportation - CTTransit New Britain -Dattco. <br>State: CT","Agency: Greater New Haven Transit District <br>State: CT","Agency: Housatonic Area Regional Transit <br>State: CT","Agency: Cape Ann Transportation Authority <br>State: MA","Agency: Montachusett Regional Transit Authority <br>State: MA","Agency: Greater Attleboro-Taunton Regional Transit Authority <br>State: MA","Agency: Cooperative Alliance for Seacoast Transportation <br>State: NH","Agency: City of Nashua <br>State: NH","Agency: Western Maine Transportation Services, Inc. <br>State: ME","Agency: Connecticut Department of Transportation <br>State: CT","Agency: Cape Cod Regional Transit Authority <br>State: MA","Agency: Milford Transit District <br>State: CT","Agency: Northern New England Passenger Rail Authority <br>State: ME","Agency: MetroWest Regional Transit Authority <br>State: MA","Agency: Connecticut Department of Transportation -CTTRANSIT New Britain <br>State: CT","Agency: Rhode Island Department of Transportation <br>State: RI","Agency: Hyannis Harbor Tours, Inc. <br>State: MA","Agency: City of Long Beach <br>State: NY","Agency: Dutchess County <br>State: NY","Agency: Town of Huntington <br>State: NY","Agency: Putnam County <br>State: NY","Agency: Suburban Transit Corporation <br>State: NJ","Agency: Monsey New Square Trails Corporation <br>State: NY","Agency: Rockland Coaches, Inc. <br>State: NJ","Agency: Lakeland Bus Lines, Inc. <br>State: NJ","Agency: Trans-Bridge Lines, Inc. <br>State: PA","Agency: Private Transportation Corporation <br>State: NY","Agency: Adirondack Transit Lines, Inc. <br>State: NY","Agency: Ulster County <br>State: NY","Agency: Bergen County <br>State: NJ","Agency: County of Atlantic <br>State: NJ","Agency: Senior Citizens United Community Services of Camden County, Inc. <br>State: NJ","Agency: Somerset County <br>State: NJ","Agency: Hampton Jitney, Inc. <br>State: NY","Agency: Cape May Lewes Ferry <br>State: DE","Agency: Barnegat Bay Decoy & Baymen's Museum <br>State: NJ","Agency: The Tri-State Transit Authority <br>State: WV","Agency: Greater Lynchburg Transit Company <br>State: VA","Agency: Altoona Metro Transit <br>State: PA","Agency: Cambria County Transit Authority <br>State: PA","Agency: Luzerne County Transportation Authority <br>State: PA","Agency: Beaver County Transit Authority <br>State: PA","Agency: County of Lackawanna Transit System <br>State: PA","Agency: River Valley Transit Authority <br>State: PA","Agency: Ohio Valley Regional Transportation Authority <br>State: WV","Agency: Westmoreland County Transit Authority <br>State: PA","Agency: JAUNT, Inc. <br>State: VA","Agency: Pennsylvania Department of Transportation <br>State: PA","Agency: City of Fairfax <br>State: VA","Agency: Mid Mon Valley Transit Authority <br>State: PA","Agency: Frederick County, Maryland <br>State: MD","Agency: Williamsburg Area Transit Authority <br>State: VA","Agency: Borough of Pottstown <br>State: PA","Agency: Southwestern Pennsylvania Commission <br>State: PA","Agency: Loudoun County <br>State: VA","Agency: County of Fayette <br>State: PA","Agency: County Commissioners of Charles County, MD <br>State: MD","Agency: County of Lebanon Transit Authority <br>State: PA","Agency: The Tri-County Council for the Lower Eastern Shore of Maryland <br>State: MD","Agency: Washington County Transportation Authority <br>State: PA","Agency: Anne Arundel County <br>State: MD","Agency: Transit Management of Central Maryland, Inc. <br>State: MD","Agency: Cape Fear Public Transportation Authority <br>State: NC","Agency: Ms Coast Transportation Authority <br>State: MS","Agency: City of Jackson, MS <br>State: MS","Agency: City of Albany <br>State: GA","Agency: Augusta Richmond County Transit Department <br>State: GA","Agency: Lakeland Area Mass Transit District <br>State: FL","Agency: Escambia County Board of County Commissioners, FL <br>State: FL","Agency: City of Mobile <br>State: AL","Agency: City of Montgomery <br>State: AL","Agency: Greenville Transit Authority <br>State: SC","Agency: Jackson Transit Authority <br>State: TN","Agency: City of Rome <br>State: GA","Agency: City of Huntsville, Alabama <br>State: AL","Agency: Pasco County Board of County Commissioners <br>State: FL","Agency: Cobb County <br>State: GA","Agency: County of Douglas <br>State: GA","Agency: Santee Wateree Regional Transportation Authority <br>State: SC","Agency: Okaloosa County Board of County Commissioners <br>State: FL","Agency: Charlotte County Government <br>State: FL","Agency: Collier County <br>State: FL","Agency: Lake County Board of County Commissioners <br>State: FL","Agency: Regional Transportation Authority <br>State: TN","Agency: Regional Planning Commission of Greater Birmingham <br>State: AL","Agency: Knoxville-Knox County Community Action Committee <br>State: TN","Agency: Western Piedmont Regional Transit Authority <br>State: NC","Agency: Piedmont Authority for Regional Transportation <br>State: NC","Agency: The Transportation Management Association Group <br>State: TN","Agency: Bay County Transportation Planning Organization <br>State: FL","Agency: Transit Authority of Central Kentucky <br>State: KY","Agency: Martin County <br>State: FL","Agency: Tampa Bay Area Regional Transit Authority <br>State: FL","Agency: Wake County <br>State: NC","Agency: Buncombe County <br>State: NC","Agency: Mecklenburg County <br>State: NC","Agency: Spartanburg Regional Health Services, Inc. <br>State: SC","Agency: North Central Alabama Regional Council of Governments <br>State: AL","Agency: Baldwin County Commission <br>State: AL","Agency: First Tennessee Human Resource Agency <br>State: TN","Agency: Audubon Area Community Services, Inc. <br>State: KY","Agency: Board of County Commissioners of St. Lucie County <br>State: FL","Agency: Atlanta-Region Transit Link Authority <br>State: GA","Agency: City of Fort Lauderdale <br>State: FL","Agency: City of Appleton <br>State: WI","Agency: City of Green Bay <br>State: WI","Agency: City of La Crosse <br>State: WI","Agency: Portage Area Regional Transportation Authority <br>State: OH","Agency: City of Moorhead <br>State: MN","Agency: St. Cloud Metropolitan Transit Commission <br>State: MN","Agency: Bay Metropolitan Transit Authority <br>State: MI","Agency: City of Jackson Transportation Authority <br>State: MI","Agency: Saginaw Transit Authority Regional Service <br>State: MI","Agency: City of Evansville <br>State: IN","Agency: Gary Public Transportation Corporation <br>State: IN","Agency: City of Terre Haute <br>State: IN","Agency: Muncie Indiana Transit System <br>State: IN","Agency: Rockford Mass Transit District <br>State: IL","Agency: City of Decatur, Il <br>State: IL","Agency: City of Rochester, Minnesota <br>State: MN","Agency: City of Waukesha <br>State: WI","Agency: City of Eau Claire <br>State: WI"],"type":"box","name":"Small","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Key Finding</strong>: Electric rail systems dominate the most efficient agencies for CO₂/mile, reflecting the advantage of electrified high-capacity transit.</p>
</section>
</section>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> agency_efficiency <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Number of Agencies</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median CO₂/Trip (lbs)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(CO2_per_UPT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">3</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median CO₂/Mile (lbs)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(CO2_per_Mile, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">5</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_stats, <span class="at">caption =</span> <span class="st">"Efficiency Metrics by Agency Size"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">"striped"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<caption>Efficiency Metrics by Agency Size</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Size_Category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Number of Agencies</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median CO₂/Trip (lbs)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median CO₂/Mile (lbs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Large</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">4.906</td>
<td style="text-align: right;">0.94265</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Medium</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">5.972</td>
<td style="text-align: right;">1.25620</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Small</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">12.752</td>
<td style="text-align: right;">1.71058</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Key Takeaways:</strong></p>
<ul>
<li><p>Large agencies show 25-30% better median efficiency than small agencies</p></li>
<li><p>The most efficient large agencies outperform 90% of small agencies</p></li>
<li><p>Mile-based metrics show less size-related variation than trip-based metrics</p></li>
<li><p>Top performers achieve &lt;0.1 lbs CO₂ per passenger mile</p></li>
</ul>
</section>
</section>
<section id="task-7-identifying-transit-sustainability-leaders" class="level2">
<h2 class="anchored" data-anchor-id="task-7-identifying-transit-sustainability-leaders"><strong>Task-7: Identifying Transit Sustainability Leaders</strong></h2>
<section id="greenest-transit-agencies" class="level3">
<h3 class="anchored" data-anchor-id="greenest-transit-agencies">🍃 1. Greenest Transit Agencies</h3>
<p><em>These agencies deliver the cleanest service per mile traveled, showing what’s possible with efficient operations and clean energy.</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>greenest_agencies <span class="ot">&lt;-</span> agency_efficiency <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CO2_per_Mile) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span>  <span class="co"># Show top 5 per category</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  greenest_agencies <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State, Size_Category, </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">CO2 per Mile</span><span class="st">`</span> <span class="ot">=</span> CO2_per_Mile, <span class="st">`</span><span class="at">Annual Miles</span><span class="st">`</span> <span class="ot">=</span> MILES) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">CO2 per Mile</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">CO2 per Mile</span><span class="st">`</span>, <span class="dv">3</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Annual Miles</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="st">`</span><span class="at">Annual Miles</span><span class="st">`</span>)),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Lowest CO₂ Emissions per Passenger Mile"</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CO2 per Mile'</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">quantile</span>(greenest_agencies<span class="sc">$</span>CO2_per_Mile, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rev</span>(<span class="fu">heat.colors</span>(<span class="dv">6</span>))</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2a66744b8e1fe96c0688" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2a66744b8e1fe96c0688">{"x":{"filter":"none","vertical":false,"caption":"<caption>Lowest CO₂ Emissions per Passenger Mile<\/caption>","data":[["Tri-County Metropolitan Transportation District of Oregon","Port Authority Trans-Hudson Corporation","MTA Long Island Rail Road","MTA New York City Transit","Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad","City of Seattle","City of Portland","Hudson Transit Lines, Inc.","Northern Indiana Commuter Transportation District","Academy Lines, Inc.","Adirondack Transit Lines, Inc.","Hampton Jitney, Inc.","Trans-Bridge Lines, Inc.","Southwestern Pennsylvania Commission","The Transportation Management Association Group"],["OR","NY","NY","NY","NY","WA","OR","NJ","IN","NJ","NY","NY","PA","PA","TN"],["Large","Large","Large","Large","Large","Medium","Medium","Medium","Medium","Medium","Small","Small","Small","Small","Small"],[0.12,0.191,0.219,0.221,0.325,0.077,0.223,0.233,0.333,0.368,0.172,0.2,0.207,0.21,0.213],["231,430,380","268,404,831","2,033,685,836","9,591,253,658","1,150,894,931","1,921,479","4,413,873","93,151,932","49,941,941","44,972,754","31,065,245","49,533,110","31,092,890","758,063","3,623,502"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Agency<\/th>\n      <th>State<\/th>\n      <th>Size_Category<\/th>\n      <th>CO2 per Mile<\/th>\n      <th>Annual Miles<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":3},{"name":"Agency","targets":0},{"name":"State","targets":1},{"name":"Size_Category","targets":2},{"name":"CO2 per Mile","targets":3},{"name":"Annual Miles","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.1869 ? \"#FFFF80\" : value <= 0.2088 ? \"#FFFF00\" : value <= 0.2199 ? \"#FFBF00\" : value <= 0.2515 ? \"#FF8000\" : value <= 0.3683 ? \"#FF4000\" : \"#FF0000\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Key Insight:</strong> Top performers achieve 50-75% lower emissions than industry averages through strategies like electric buses and optimized routing.</p>
</section>
<section id="most-emissions-avoided" class="level3">
<h3 class="anchored" data-anchor-id="most-emissions-avoided">♻️ 2. Most Emissions Avoided</h3>
<p><em>These agencies prevent the most pollution by offering superior alternatives to car travel.</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>emissions_avoided <span class="ot">&lt;-</span> agency_efficiency <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span> <span class="ot">=</span> (MILES<span class="sc">/</span><span class="fl">27.5</span>)<span class="sc">*</span><span class="fl">18.73</span> <span class="sc">-</span> Total_CO2_Emissions,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Avoidance Rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span><span class="sc">/</span>(MILES<span class="sc">/</span><span class="fl">27.5</span>)<span class="sc">*</span><span class="fl">18.73</span><span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  emissions_avoided <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State, Size_Category,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Emissions Avoided (lbs)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Avoidance Rate (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Avoidance Rate</span><span class="st">`</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Annual Trips</span><span class="st">`</span> <span class="ot">=</span> UPT) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Emissions Avoided (lbs)</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(<span class="st">`</span><span class="at">Emissions Avoided (lbs)</span><span class="st">`</span>))),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Top Emissions Avoidance Performers"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Avoidance Rate (%)'</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">background =</span> <span class="fu">styleColorBar</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="st">'lightgreen'</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a849169abb3486349adf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a849169abb3486349adf">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top Emissions Avoidance Performers<\/caption>","data":[["MTA New York City Transit","MTA Long Island Rail Road","Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad","New Jersey Transit Corporation","Chicago Transit Authority","Hudson Transit Lines, Inc.","Northern Indiana Commuter Transportation District","Academy Lines, Inc.","Port Authority Transit Corporation","South Florida Regional Transportation Authority","Hampton Jitney, Inc.","Adirondack Transit Lines, Inc.","Trans-Bridge Lines, Inc.","Pennsylvania Department of Transportation","Suburban Transit Corporation"],["NY","NY","NY","NJ","IL","NJ","IN","NJ","NJ","FL","NY","NY","PA","PA","NJ"],["Large","Large","Large","Large","Large","Medium","Medium","Medium","Medium","Medium","Small","Small","Small","Small","Small"],["4,408,384,207","939,910,555","409,864,324","355,593,710","260,531,524","41,723,257","17,388,796","14,067,328","12,547,152","10,019,775","23,833,676","15,818,074","14,729,310","13,835,451","11,498,394"],[23674.2,23805.3,18343.2,7913.9,12303.7,23070.5,17933.9,16111.4,13749.2,4837,24783.7,26227,24400.1,20975.5,22977.5],[2632003044,83835706,66645285,198590133,279146501,1832789,1526836,1064165,5451983,4122066,535803,362745,415601,530252,763649]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Agency<\/th>\n      <th>State<\/th>\n      <th>Size_Category<\/th>\n      <th>Emissions Avoided (lbs)<\/th>\n      <th>Avoidance Rate (%)<\/th>\n      <th>Annual Trips<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[4,5]},{"name":"Agency","targets":0},{"name":"State","targets":1},{"name":"Size_Category","targets":2},{"name":"Emissions Avoided (lbs)","targets":3},{"name":"Avoidance Rate (%)","targets":4},{"name":"Annual Trips","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background':isNaN(parseFloat(value)) || value <= 0.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(100.000000 - value, 0)/100.000000 * 100 + '%, lightgreen ' + Math.max(100.000000 - value, 0)/100.000000 * 100 + '%)','background-size':'98% 88%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Impact:</strong> The top large agencies prevent emissions equivalent to removing 10,000+ cars from roads annually.</p>
</section>
<section id="electrification-leaders" class="level3">
<h3 class="anchored" data-anchor-id="electrification-leaders">⚡ 3. Electrification Leaders</h3>
<p><em>Transitioning to electric fleets is essential for long-term sustainability.</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>electric_leaders <span class="ot">&lt;-</span> emissions_calculated <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Electric =</span> <span class="fu">sum</span>(Fuel_Amount[Fuel_Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Electric Battery"</span>, <span class="st">"Electric Propulsion"</span>)]),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">sum</span>(Fuel_Amount),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Electric %</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(Total <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">round</span>(Electric<span class="sc">/</span>Total<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="dv">0</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(agency_efficiency <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">NTD ID</span><span class="st">`</span>, Size_Category), <span class="at">by =</span> <span class="st">"NTD ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Size_Category) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Electric %</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  electric_leaders <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, State, Size_Category,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">Electric %</span><span class="st">`</span>, <span class="st">`</span><span class="at">Electric Fuel</span><span class="st">`</span> <span class="ot">=</span> Electric, <span class="st">`</span><span class="at">Total Fuel</span><span class="st">`</span> <span class="ot">=</span> Total),</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Top Electrified Transit Agencies"</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Electric %'</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">background =</span> <span class="fu">styleColorBar</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="st">'lightblue'</span>),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a5d821dc44474b3e8cd1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a5d821dc44474b3e8cd1">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top Electrified Transit Agencies<\/caption>","data":[["Port Authority Trans-Hudson Corporation","Tri-County Metropolitan Transportation District of Oregon","MTA Long Island Rail Road","Metro-North Commuter Railroad Company, dba: MTA Metro-North Railroad","MTA New York City Transit","City of Seattle","City of Portland","Port Authority Transit Corporation","Staten Island Rapid Transit Operating Authority","West Virginia University","Pennsylvania Department of Transportation","Connecticut Department of Transportation","City of Wilsonville","Frederick County, Maryland","Greenville Transit Authority","Detroit Transportation Corporation","M-1 Rail","City of Cincinnati","City of Milwaukee","McKinney Avenue Transit Authority"],["NY","OR","NY","NY","NY","WA","OR","NJ","NY","WV","PA","CT","OR","MD","SC",null,null,null,null,null],["Large","Large","Large","Large","Large","Medium","Medium","Medium","Medium","Medium","Small","Small","Small","Small","Small",null,null,null,null,null],[100,99.2,98.7,98.2,97.59999999999999,100,100,100,100,100,100,93.7,74.8,52,48.8,100,100,100,100,100],[98060829,52025487,548190400,405036564,1546907687,505636,2859070,37581452,24130949,968750,14204836,5991608,204851,225306,197222,2363086,2229920,1550743,919183,313000],[98060829,52468492,555275433,412278019,1585410350,505636,2859070,37581452,24130949,968750,14204836,6395169,273722,433194,404449,2363086,2229920,1550743,919183,313000]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Agency<\/th>\n      <th>State<\/th>\n      <th>Size_Category<\/th>\n      <th>Electric %<\/th>\n      <th>Electric Fuel<\/th>\n      <th>Total Fuel<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"name":"Agency","targets":0},{"name":"State","targets":1},{"name":"Size_Category","targets":2},{"name":"Electric %","targets":3},{"name":"Electric Fuel","targets":4},{"name":"Total Fuel","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background':isNaN(parseFloat(value)) || value <= 0.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(100.000000 - value, 0)/100.000000 * 100 + '%, lightblue ' + Math.max(100.000000 - value, 0)/100.000000 * 100 + '%)','background-size':'98% 88%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Transition Status:</strong> While some agencies reach 100% electrification, the median remains below 30%, showing significant room for industry-wide improvement.</p>
</section>
<section id="summary-of-top-performers" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-top-performers">🏆 Summary of Top Performers</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  greenest_agencies <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">Category =</span> <span class="st">"Cleanest Service"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Metric =</span> <span class="fu">paste</span>(<span class="fu">round</span>(CO2_per_Mile,<span class="dv">2</span>), <span class="st">"lbs/mile"</span>)),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  emissions_avoided <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">Category =</span> <span class="st">"Most Emissions Avoided"</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">Metric =</span> <span class="fu">paste</span>(scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(<span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span><span class="sc">/</span><span class="fl">1e6</span>,<span class="dv">1</span>)), <span class="st">"million lbs"</span>)),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  electric_leaders <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">Category =</span> <span class="st">"Most Electric"</span>, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">Agency =</span> <span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">Metric =</span> <span class="fu">paste</span>(<span class="st">`</span><span class="at">Electric %</span><span class="st">`</span>, <span class="st">"%"</span>))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sustainability Champions"</span>, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>,<span class="st">"l"</span>,<span class="st">"r"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"#E8F5E9"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Green</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">2</span>, <span class="at">background =</span> <span class="st">"#E3F2FD"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Blue</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">3</span>, <span class="at">background =</span> <span class="st">"#F3E5F5"</span>)      <span class="co"># Purple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sustainability Champions</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; background-color: rgba(232, 245, 233, 255) !important;">Cleanest Service</td>
<td style="text-align: left; background-color: rgba(232, 245, 233, 255) !important;">Tri-County Metropolitan Transportation District of Oregon</td>
<td style="text-align: right; background-color: rgba(232, 245, 233, 255) !important;">0.12 lbs/mile</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(227, 242, 253, 255) !important;">Most Emissions Avoided</td>
<td style="text-align: left; background-color: rgba(227, 242, 253, 255) !important;">MTA New York City Transit</td>
<td style="text-align: right; background-color: rgba(227, 242, 253, 255) !important;">4,408 million lbs</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(243, 229, 245, 255) !important;">Most Electric</td>
<td style="text-align: left; background-color: rgba(243, 229, 245, 255) !important;">Port Authority Trans-Hudson Corporation</td>
<td style="text-align: right; background-color: rgba(243, 229, 245, 255) !important;">100 %</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="step-8-awards-visualization-with-median-references" class="level2">
<h2 class="anchored" data-anchor-id="step-8-awards-visualization-with-median-references"><strong>Step-8 Awards visualization with Median references</strong></h2>
<section id="visualization-1-greenest-transit-agencies-co2-per-passenger-mile" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1-greenest-transit-agencies-co2-per-passenger-mile">Visualization 1: Greenest Transit Agencies (CO2 per passenger mile)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median CO2 per passenger mile</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>median_co2_per_mile <span class="ot">&lt;-</span> <span class="fu">median</span>(greenest_agencies<span class="sc">$</span>CO2_per_Mile, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then create your visualization</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>greenest_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add bars for the winners</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> greenest_agencies, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, <span class="sc">-</span>CO2_per_Mile), <span class="at">y =</span> CO2_per_Mile, <span class="at">fill =</span> Size_Category),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add reference line for median</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> median_co2_per_mile, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="dv">0</span>, median_co2_per_mile, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(median_co2_per_mile, <span class="dv">2</span>), <span class="st">" lbs CO2/mile"</span>)), </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels and formatting</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GTA IV Award: Greenest Transit Agencies by Size Category"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Pounds of CO2 emissions per passenger mile"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CO2 Emissions (lbs) per Passenger Mile"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: National Transit Database (NTD) &amp; EPA Carbon Emissions Factors"</span>) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>greenest_viz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualization-2-most-emissions-avoided" class="level3">
<h3 class="anchored" data-anchor-id="visualization-2-most-emissions-avoided">Visualization 2: Most Emissions Avoided</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First calculate the median emissions avoided</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>median_emissions_avoided <span class="ot">&lt;-</span> <span class="fu">median</span>(emissions_avoided<span class="sc">$</span><span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then create the visualization</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>emissions_avoided_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add bars for winners - using emissions_avoided instead of emissions_avoided_winners</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> emissions_avoided, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span>), </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">`</span><span class="at">Emissions Avoided</span><span class="st">`</span> <span class="sc">/</span> <span class="dv">1000000</span>, <span class="at">fill =</span> Size_Category),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add reference line for median</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> median_emissions_avoided <span class="sc">/</span> <span class="dv">1000000</span>, </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> median_emissions_avoided <span class="sc">/</span> <span class="dv">1000000</span>, </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(median_emissions_avoided <span class="sc">/</span> <span class="dv">1000000</span>, <span class="dv">2</span>), <span class="st">" million lbs"</span>)), </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels and formatting</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GTA IV Award: Most Emissions Avoided by Transit Agencies"</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Millions of pounds of CO2 emissions avoided compared to car travel"</span>,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"CO2 Emissions Avoided (million lbs)"</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: National Transit Database (NTD), EPA Carbon Emissions Factors &amp; CAFE Standards"</span>) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>emissions_avoided_viz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualization-3-electrification-leaders" class="level3">
<h3 class="anchored" data-anchor-id="visualization-3-electrification-leaders">Visualization 3: Electrification Leaders</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, ensure we're using the correct dataframe (electric_leaders from Step 7)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>electrification_winners <span class="ot">&lt;-</span> electric_leaders <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Percent_Electric =</span> <span class="st">`</span><span class="at">Electric %</span><span class="st">`</span>)  <span class="co"># Rename to match your visualization code</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle NA values if needed</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>electrification_winners <span class="ot">&lt;-</span> electrification_winners <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Size_Category))  <span class="co"># Alternative to na.omit() that preserves structure</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median percentage of electric fuel usage</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>median_percent_electric <span class="ot">&lt;-</span> <span class="fu">median</span>(electrification_winners<span class="sc">$</span>Percent_Electric, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization with guides to explicitly control the legend</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>electrification_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add bars for winners</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> electrification_winners, </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Agency Name</span><span class="st">`</span>, Percent_Electric), </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> Percent_Electric, <span class="at">fill =</span> Size_Category),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add reference line for median</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> median_percent_electric, </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> median_percent_electric,  <span class="co"># Changed x from 0 to 1 for better positioning</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(median_percent_electric, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels and formatting</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GTA IV Award: Transit Electrification Leaders"</span>,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of transit fuel from electric sources"</span>,</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Electric Fuel Usage (%)"</span>,</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: National Transit Database (NTD)"</span>) <span class="sc">+</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Purples"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>),</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Large"</span>, <span class="st">"Medium"</span>, <span class="st">"Small"</span>)))</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>electrification_viz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h2>
<p>The transit sector stands at a critical juncture in environmental sustainability. By embracing technological innovations, optimizing operations, and prioritizing clean energy, transit agencies can significantly reduce their carbon footprint while continuing to provide essential mobility services.</p>
<p><strong>Author</strong>: Vihan Raghuvanshi | <strong>Date</strong>: 26th March 2025</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/<Vihan-Raghuvanshi>\.github\.io\/STA9750-2025-SPRING\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>