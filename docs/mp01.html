<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Commission to Analyze Taxpayer Spending (CATS) - Policies Review – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0cb5735cee7cc8ae56ecf7c7052d4876.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary"><strong>Executive Summary</strong></a>
  <ul class="collapse">
  <li><a href="#key-policy-recommendations-findings" id="toc-key-policy-recommendations-findings" class="nav-link" data-scroll-target="#key-policy-recommendations-findings">Key Policy Recommendations &amp; Findings</a>
  <ul class="collapse">
  <li><a href="#policy-i-capping-non-mayoral-salaries" id="toc-policy-i-capping-non-mayoral-salaries" class="nav-link" data-scroll-target="#policy-i-capping-non-mayoral-salaries">Policy I: Capping Non-Mayoral Salaries</a></li>
  <li><a href="#policy-ii-reducing-overtime-via-strategic-hiring" id="toc-policy-ii-reducing-overtime-via-strategic-hiring" class="nav-link" data-scroll-target="#policy-ii-reducing-overtime-via-strategic-hiring">Policy II: Reducing Overtime via Strategic Hiring</a></li>
  <li><a href="#policy-iii-optimizing-manager-to-staff-ratios" id="toc-policy-iii-optimizing-manager-to-staff-ratios" class="nav-link" data-scroll-target="#policy-iii-optimizing-manager-to-staff-ratios">Policy III: Optimizing Manager-to-Staff Ratios</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><strong>Introduction</strong></a>
  <ul class="collapse">
  <li><a href="#context-scope" id="toc-context-scope" class="nav-link" data-scroll-target="#context-scope">Context &amp; Scope</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><strong>Data</strong></a>
  <ul class="collapse">
  <li><a href="#source" id="toc-source" class="nav-link" data-scroll-target="#source">Source</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data Description</a>
  <ul class="collapse">
  <li><a href="#core-variables" id="toc-core-variables" class="nav-link" data-scroll-target="#core-variables">Core Variables</a></li>
  <li><a href="#derived-variables" id="toc-derived-variables" class="nav-link" data-scroll-target="#derived-variables">Derived Variables</a></li>
  <li><a href="#standardization" id="toc-standardization" class="nav-link" data-scroll-target="#standardization">Standardization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#policy-analysis" id="toc-policy-analysis" class="nav-link" data-scroll-target="#policy-analysis"><strong>Policy Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#policy-i-capping-salaries-at-mayoral-level" id="toc-policy-i-capping-salaries-at-mayoral-level" class="nav-link" data-scroll-target="#policy-i-capping-salaries-at-mayoral-level"><strong>Policy I: Capping Salaries at Mayoral Level</strong></a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><strong>Overview</strong></a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><em>Methodology</em></a></li>
  <li><a href="#analysis-and-findings" id="toc-analysis-and-findings" class="nav-link" data-scroll-target="#analysis-and-findings"><em>Analysis and Findings</em></a></li>
  <li><a href="#policy-impact-summary" id="toc-policy-impact-summary" class="nav-link" data-scroll-target="#policy-impact-summary"><em>Policy Impact Summary</em></a></li>
  <li><a href="#implementation-considerations" id="toc-implementation-considerations" class="nav-link" data-scroll-target="#implementation-considerations"><em>Implementation Considerations</em></a></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations"><em>Recommendations</em></a></li>
  </ul></li>
  <li><a href="#policy-ii-reducing-overtime-via-strategic-hiring-1" id="toc-policy-ii-reducing-overtime-via-strategic-hiring-1" class="nav-link" data-scroll-target="#policy-ii-reducing-overtime-via-strategic-hiring-1"><strong>Policy II: Reducing Overtime via Strategic Hiring</strong></a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1"><em>Overview</em></a></li>
  <li><a href="#methodology-1" id="toc-methodology-1" class="nav-link" data-scroll-target="#methodology-1"><em>Methodology</em></a></li>
  <li><a href="#analysis-and-findings-1" id="toc-analysis-and-findings-1" class="nav-link" data-scroll-target="#analysis-and-findings-1"><em>Analysis and Findings</em></a></li>
  <li><a href="#policy-impact-summary-1" id="toc-policy-impact-summary-1" class="nav-link" data-scroll-target="#policy-impact-summary-1"><em>Policy Impact Summary</em></a></li>
  <li><a href="#implementation-considerations-1" id="toc-implementation-considerations-1" class="nav-link" data-scroll-target="#implementation-considerations-1"><em>Implementation Considerations</em></a></li>
  <li><a href="#recommendations-1" id="toc-recommendations-1" class="nav-link" data-scroll-target="#recommendations-1"><em>Recommendations</em></a></li>
  </ul></li>
  <li><a href="#policy-iii-optimizing-manager-to-staff-ratios-1" id="toc-policy-iii-optimizing-manager-to-staff-ratios-1" class="nav-link" data-scroll-target="#policy-iii-optimizing-manager-to-staff-ratios-1"><strong>Policy III: Optimizing Manager-to-Staff Ratios</strong></a>
  <ul class="collapse">
  <li><a href="#overview-2" id="toc-overview-2" class="nav-link" data-scroll-target="#overview-2"><em>Overview</em></a></li>
  <li><a href="#methodology-2" id="toc-methodology-2" class="nav-link" data-scroll-target="#methodology-2"><em>Methodology</em></a></li>
  <li><a href="#analysis-and-findings-2" id="toc-analysis-and-findings-2" class="nav-link" data-scroll-target="#analysis-and-findings-2"><em>Analysis and Findings</em></a></li>
  <li><a href="#step-3-calculating-potential-savings-from-optimized-ratios" id="toc-step-3-calculating-potential-savings-from-optimized-ratios" class="nav-link" data-scroll-target="#step-3-calculating-potential-savings-from-optimized-ratios"><em>Step 3: Calculating Potential Savings from Optimized Ratios</em></a></li>
  </ul></li>
  <li><a href="#policy-impact-summary-2" id="toc-policy-impact-summary-2" class="nav-link" data-scroll-target="#policy-impact-summary-2">Policy Impact Summary</a></li>
  <li><a href="#implementation-strategy" id="toc-implementation-strategy" class="nav-link" data-scroll-target="#implementation-strategy">Implementation Strategy:</a></li>
  </ul></li>
  <li><a href="#overall-implementation-prioritization-for-3-policies" id="toc-overall-implementation-prioritization-for-3-policies" class="nav-link" data-scroll-target="#overall-implementation-prioritization-for-3-policies"><strong>Overall Implementation Prioritization for 3 policies</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>Conclusion</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Commission to Analyze Taxpayer Spending (CATS) - Policies Review</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="executive-summary" class="level1">
<h1><strong>Executive Summary</strong></h1>
<p>This report analyzes New York City’s payroll data (2014–2024) to identify inefficiencies in taxpayer-funded compensation and proposes three actionable reforms. By addressing salary disparities, overtime costs, and managerial overstaffing, these policies could yield <strong>$98.5 million in cumulative savings over 10 years</strong> while promoting equitable resource allocation.</p>
<p>The analysis leverages 6.2 million payroll records across 169 agencies and 1979 positions to identify actionable opportunities. Each policy recommendation is backed by rigorous data analysis and considers both potential savings and implementation risks.</p>
<section id="key-policy-recommendations-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-policy-recommendations-findings">Key Policy Recommendations &amp; Findings</h2>
<section id="policy-i-capping-non-mayoral-salaries" class="level3">
<h3 class="anchored" data-anchor-id="policy-i-capping-non-mayoral-salaries">Policy I: Capping Non-Mayoral Salaries</h3>
<ul>
<li><strong>Excess Pay Identified</strong>: $2.65 million paid to 76 employees in roles exceeding mayoral compensation</li>
<li><strong>Savings Mechanism</strong>: Cap salaries for non-critical roles at mayoral levels<br>
</li>
<li><strong>Risk Mitigation</strong>: Exempt specialized positions (actuaries, investment directors) to retain talent</li>
<li><strong>Implementation</strong>: Adopt phased caps (2–3 years) and benchmark salaries to market rates</li>
</ul>
</section>
<section id="policy-ii-reducing-overtime-via-strategic-hiring" class="level3">
<h3 class="anchored" data-anchor-id="policy-ii-reducing-overtime-via-strategic-hiring">Policy II: Reducing Overtime via Strategic Hiring</h3>
<ul>
<li><strong>Top Opportunity</strong>: Sanitation ($1M/year), Correction ($967K/year), and Building ($938K/year) agencies</li>
<li><strong>Savings Potential</strong>: $75 million over 10 years by hiring 3–5 FTEs/year to replace 3,000+ overtime hours</li>
<li><strong>Key Targets</strong>: Prioritize roles like Sanitation Mechanics and Correction Legal Coordinators</li>
</ul>
</section>
<section id="policy-iii-optimizing-manager-to-staff-ratios" class="level3">
<h3 class="anchored" data-anchor-id="policy-iii-optimizing-manager-to-staff-ratios">Policy III: Optimizing Manager-to-Staff Ratios</h3>
<ul>
<li><strong>Inefficiency</strong>: Managerial ratios exceed 1:15 in multiple agencies including Education and Health</li>
<li><strong>Savings</strong>: $20.48 million/year by streamlining excess leadership roles</li>
<li><strong>Recommendation</strong>: Reinvest savings into frontline services and track turnover post-implementation</li>
</ul>
</section>
</section>
</section>
<section id="introduction" class="level1">
<h1><strong>Introduction</strong></h1>
<p>New York City’s taxpayer-funded payroll expenditures surged by <strong>56.9%</strong> between <strong>Fiscal Years 2014 and 2024</strong>, growing from $21.8 billion to $34.2 billion. This trend, revealed by the <a href="https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e">Citywide Payroll Data</a> (NYC OpenData), highlights systemic inefficiencies in compensation practices that demand urgent reform. At the request of the Commission to Analyze Taxpayer Spending (CATS), this analysis evaluates opportunities for fiscal responsibility and equitable resource allocation.</p>
<section id="context-scope" class="level2">
<h2 class="anchored" data-anchor-id="context-scope">Context &amp; Scope</h2>
<p>The dataset, updated through June 2024, includes granular details on:<br>
- <em>Compensation</em>: Base salaries, overtime pay, total earnings, and pay basis (hourly, annual, etc.) - <em>Roles</em>: Job titles, agency affiliations, and work locations</p>
<p>Three critical inefficiencies drive this analysis:</p>
<ol type="1">
<li><strong>Salary Disparities</strong>: Senior officials earn <em>2.4× the median salary</em> of rank-and-file employees—a gap exceeding both public-sector norms and mayoral compensation thresholds</li>
<li><strong>Overtime Overuse</strong>: Several agencies allocate <em>20% of total hours</em> to overtime, incurring avoidable 1.5× wage premiums</li>
<li><strong>Inefficient Management Ratios</strong>: Multiple agencies employ managers at ratios below 1:15 staff-to-supervisor, inflating administrative costs without operational justification</li>
</ol>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li>Quantify excess spending in senior compensation, overtime, and managerial staffing</li>
<li>Model the fiscal impact of three policy reforms:
<ul>
<li>Capping non-critical salaries at mayoral levels</li>
<li>Replacing high overtime hours with strategic hiring</li>
<li>Optimizing manager-to-staff ratios to 1:15</li>
</ul></li>
<li>Provide a final recommendation</li>
</ol>
</section>
</section>
<section id="data" class="level1">
<h1><strong>Data</strong></h1>
<section id="source" class="level2">
<h2 class="anchored" data-anchor-id="source">Source</h2>
<p>This analysis leverages the <a href="https://data.cityofnewyork.us/resource/k397-673e.json">NYC Payroll Data</a> dataset, published by the <strong>New York City Office of Payroll Administration (OPA)</strong> on <strong>NYC OpenData</strong>. The dataset provides granular details on compensation for all municipal employees, including full-time, part-time, and seasonal workers across <strong>169 city agencies</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Download the dataset by copying the code below">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Download the dataset by copying the code below
</div>
</div>
<div class="callout-body-container callout-body">
<p>Click on code</p>
</div>
</div>
<div class="cell" data-caption="Data Import Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"data/mp01/nyc_payroll_export.csv"</span>)){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"data/mp01"</span>, <span class="at">showWarnings=</span><span class="cn">FALSE</span>, <span class="at">recursive=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  ENDPOINT <span class="ot">&lt;-</span> <span class="st">"https://data.cityofnewyork.us/resource/k397-673e.json"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"httr2"</span>)) <span class="fu">install.packages</span>(<span class="st">"httr2"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(httr2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"jsonlite"</span>)) <span class="fu">install.packages</span>(<span class="st">"jsonlite"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(jsonlite)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"dplyr"</span>)) <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"readr"</span>)) <span class="fu">install.packages</span>(<span class="st">"readr"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"stringr"</span>)) <span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  BATCH_SIZE <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  OFFSET     <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  END_OF_EXPORT <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  ALL_DATA <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="sc">!</span>END_OF_EXPORT){</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Requesting items"</span>, OFFSET, <span class="st">"to"</span>, BATCH_SIZE <span class="sc">+</span> OFFSET, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    req <span class="ot">&lt;-</span> <span class="fu">request</span>(ENDPOINT) <span class="sc">|&gt;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">$limit</span><span class="st">`</span>  <span class="ot">=</span> BATCH_SIZE, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">$offset</span><span class="st">`</span> <span class="ot">=</span> OFFSET)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    batch_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">resp_body_string</span>(resp))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    ALL_DATA <span class="ot">&lt;-</span> <span class="fu">c</span>(ALL_DATA, <span class="fu">list</span>(batch_data))</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">NROW</span>(batch_data) <span class="sc">!=</span> BATCH_SIZE){</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>      END_OF_EXPORT <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"End of Data Export Reached</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      OFFSET <span class="ot">&lt;-</span> OFFSET <span class="sc">+</span> BATCH_SIZE</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  ALL_DATA <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ALL_DATA)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Data export complete:"</span>, <span class="fu">NROW</span>(ALL_DATA), <span class="st">"rows and"</span>, <span class="fu">NCOL</span>(ALL_DATA), <span class="st">"columns."</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(ALL_DATA, <span class="st">"data/mp01/nyc_payroll_export.csv"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data Description</h2>
<p>The dataset includes the following key variables:</p>
<section id="core-variables" class="level3">
<h3 class="anchored" data-anchor-id="core-variables">Core Variables</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fiscal_year</code></td>
<td>Fiscal year of payroll record (July–June cycle)</td>
</tr>
<tr class="even">
<td><code>agency_name</code></td>
<td>Name of employing agency (e.g., “Dept Of Education”)</td>
</tr>
<tr class="odd">
<td><code>title_description</code></td>
<td>Job title (e.g., “Sanitation Worker”)</td>
</tr>
<tr class="even">
<td><code>base_salary</code></td>
<td>Annual or hourly base pay (unadjusted for overtime)</td>
</tr>
<tr class="odd">
<td><code>regular_hours</code></td>
<td>Hours worked at standard pay rate</td>
</tr>
<tr class="even">
<td><code>ot_hours</code></td>
<td>Overtime hours worked (paid at 1.5× base rate)</td>
</tr>
<tr class="odd">
<td><code>work_location_borough</code></td>
<td>Primary work location (Bronx, Brooklyn, Manhattan, Queens, Staten Island)</td>
</tr>
<tr class="even">
<td><code>pay_basis</code></td>
<td>Compensation structure (e.g., “per Annum”, “per Hour”, “Per Day”)</td>
</tr>
</tbody>
</table>
</section>
<section id="derived-variables" class="level3">
<h3 class="anchored" data-anchor-id="derived-variables">Derived Variables</h3>
<ul>
<li><strong><code>Total_Salary</code></strong>: Calculated total compensation accounting for overtime premiums and pay basis.
<ul>
<li>pay_basis == “per Annum” ~ base_salary</li>
<li>pay_basis == “per Hour” ~ base_salary * (regular_hours + 1.5 * ot_hours)</li>
<li>pay_basis == “Per Day” ~ base_salary * ((regular_hours + ot_hours) / 7.5)</li>
</ul></li>
</ul>
<div class="cell" data-caption="Total Salary Calculation Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code shows how total compensation was calculated</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>total_comp_calculation <span class="ot">&lt;-</span> <span class="cf">function</span>(nyc_payroll) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  nyc_clean <span class="ot">&lt;-</span> nyc_payroll <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_compensation =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># High-ranking officials with fixed salary</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        pay_basis <span class="sc">==</span> <span class="st">"per Annum"</span> <span class="sc">~</span> base_salary,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Hourly employees: regular pay + 1.5x for OT</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        pay_basis <span class="sc">==</span> <span class="st">"per Hour"</span> <span class="sc">~</span> base_salary <span class="sc">*</span> (regular_hours <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> ot_hours),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Day-rate employees: convert total hours to days (7.5 hours/day)</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        pay_basis <span class="sc">==</span> <span class="st">"Per Day"</span> <span class="sc">~</span> base_salary <span class="sc">*</span> ((regular_hours <span class="sc">+</span> ot_hours) <span class="sc">/</span> <span class="fl">7.5</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fallback for unexpected pay types</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(nyc_clean)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="standardization" class="level3">
<h3 class="anchored" data-anchor-id="standardization">Standardization</h3>
<ul>
<li><strong>Text Formatting:</strong> Converted <code>agency_name</code>, <code>title_description</code>, and <code>work_location_borough</code> to title case for consistency</li>
<li><strong>Borough Names:</strong> Corrected inconsistencies (e.g., “Staten Island” vs.&nbsp;“STATENISLAND”)</li>
</ul>
</section>
</section>
</section>
<section id="policy-analysis" class="level1">
<h1><strong>Policy Analysis</strong></h1>
<section id="policy-i-capping-salaries-at-mayoral-level" class="level2">
<h2 class="anchored" data-anchor-id="policy-i-capping-salaries-at-mayoral-level"><strong>Policy I: Capping Salaries at Mayoral Level</strong></h2>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview"><strong>Overview</strong></h3>
<p>This policy evaluates the financial impact of capping municipal salaries at the New York City Mayor’s level, identifying overpaid employees, potential savings, and implementation considerations.</p>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology"><em>Methodology</em></h3>
<ol type="1">
<li>Identify the Mayor’s salary per fiscal year</li>
<li>Compare salaries to find employees earning more than the Mayor</li>
<li>Calculate excess compensation and estimated savings</li>
<li>Analyze agency- and position-level impacts</li>
</ol>
</section>
<section id="analysis-and-findings" class="level3">
<h3 class="anchored" data-anchor-id="analysis-and-findings"><em>Analysis and Findings</em></h3>
<section id="step-1-identifying-the-mayors-salary" class="level4">
<h4 class="anchored" data-anchor-id="step-1-identifying-the-mayors-salary"><em>Step 1: Identifying the Mayor’s Salary</em></h4>
<div class="cell" data-caption="Mayor's Salary Identification Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mayor_salary <span class="ot">&lt;-</span> nyc_clean <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Position <span class="sc">==</span> <span class="st">"Mayor"</span> <span class="sc">|</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>           (Agency <span class="sc">==</span> <span class="st">"Office Of The Mayor"</span> <span class="sc">&amp;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_detect</span>(Position, <span class="st">"(?i)mayor"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mayor_Salary =</span> <span class="fu">max</span>(Total_Salary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Mayor_Salary <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the identified salaries</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mayor_salary, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Fiscal Year"</span>, <span class="st">"Mayor's Salary"</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Mayor's Annual Salary by Fiscal Year"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mayor's Annual Salary by Fiscal Year</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Fiscal Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mayor's Salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2,014</td>
<td style="text-align: right;">245,760</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,015</td>
<td style="text-align: right;">256,819</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,016</td>
<td style="text-align: right;">263,239</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,017</td>
<td style="text-align: right;">271,136</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,018</td>
<td style="text-align: right;">271,136</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,019</td>
<td style="text-align: right;">282,659</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,020</td>
<td style="text-align: right;">291,139</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,021</td>
<td style="text-align: right;">291,139</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,022</td>
<td style="text-align: right;">291,139</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,023</td>
<td style="text-align: right;">275,000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,024</td>
<td style="text-align: right;">313,941</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="step-2-identifying-employees-earning-more-than-the-mayor" class="level4">
<h4 class="anchored" data-anchor-id="step-2-identifying-employees-earning-more-than-the-mayor"><em>Step 2: Identifying Employees Earning More Than the Mayor</em></h4>
<div class="cell" data-caption="Employees Above Mayor Salary Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>employees_above_mayor <span class="ot">&lt;-</span> nyc_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Position <span class="sc">==</span> <span class="st">"Mayor"</span> <span class="sc">|</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>             (Agency <span class="sc">==</span> <span class="st">"Office Of The Mayor"</span> <span class="sc">&amp;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str_detect</span>(Position, <span class="st">"(?i)mayor"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mayor_salary, <span class="at">by =</span> <span class="st">"Fiscal_Year"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Earns_More_Than_Mayor =</span> <span class="fu">ifelse</span>(Total_Salary <span class="sc">&gt;</span> Mayor_Salary, <span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Excess_Amount =</span> <span class="fu">ifelse</span>(Earns_More_Than_Mayor <span class="sc">==</span> <span class="st">"Yes"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                          Total_Salary <span class="sc">-</span> Mayor_Salary, <span class="dv">0</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Earns_More_Than_Mayor <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Fiscal_Year, Agency, Position, Total_Salary, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         Mayor_Salary, Excess_Amount) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Excess_Amount))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table of top positions exceeding mayor's salary</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>top_positions <span class="ot">&lt;-</span> employees_above_mayor <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Position) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Excess =</span> <span class="fu">mean</span>(Excess_Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Excess =</span> <span class="fu">sum</span>(Excess_Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(top_positions, </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Position"</span>, <span class="st">"Count"</span>, <span class="st">"Average Excess"</span>, <span class="st">"Total Excess"</span>),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Top 10 Positions Exceeding Mayor's Salary"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="st">"100px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 Positions Exceeding Mayor's Salary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Position</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Average Excess</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Excess</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Director Of Investments</td>
<td style="text-align: right; width: 100px;">13</td>
<td style="text-align: right; width: 100px;">15,184.62</td>
<td style="text-align: right; width: 100px;">197,400.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chief Actuary</td>
<td style="text-align: right; width: 100px;">11</td>
<td style="text-align: right; width: 100px;">25,477.64</td>
<td style="text-align: right; width: 100px;">280,254.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">President</td>
<td style="text-align: right; width: 100px;">11</td>
<td style="text-align: right; width: 100px;">13,790.91</td>
<td style="text-align: right; width: 100px;">151,700.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pension Investment Advisor</td>
<td style="text-align: right; width: 100px;">10</td>
<td style="text-align: right; width: 100px;">69,013.30</td>
<td style="text-align: right; width: 100px;">690,133.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chancellor</td>
<td style="text-align: right; width: 100px;">7</td>
<td style="text-align: right; width: 100px;">76,754.43</td>
<td style="text-align: right; width: 100px;">537,281.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Administrative Staff Analyst</td>
<td style="text-align: right; width: 100px;">6</td>
<td style="text-align: right; width: 100px;">9,261.00</td>
<td style="text-align: right; width: 100px;">55,566.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chair</td>
<td style="text-align: right; width: 100px;">3</td>
<td style="text-align: right; width: 100px;">123,568.00</td>
<td style="text-align: right; width: 100px;">370,704.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Assistant Superintendent</td>
<td style="text-align: right; width: 100px;">2</td>
<td style="text-align: right; width: 100px;">72,207.00</td>
<td style="text-align: right; width: 100px;">144,414.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City Medical Specialist</td>
<td style="text-align: right; width: 100px;">2</td>
<td style="text-align: right; width: 100px;">27,213.23</td>
<td style="text-align: right; width: 100px;">54,426.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Executive Agency Counsel</td>
<td style="text-align: right; width: 100px;">2</td>
<td style="text-align: right; width: 100px;">77,295.50</td>
<td style="text-align: right; width: 100px;">154,591.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="step-3-total-savings-and-impacted-groups" class="level4">
<h4 class="anchored" data-anchor-id="step-3-total-savings-and-impacted-groups"><em>Step 3: Total Savings and Impacted Groups</em></h4>
<div class="cell" data-caption="Policy 1 Savings Calculation Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual summary</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>annual_summary <span class="ot">&lt;-</span> employees_above_mayor <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Overpaid_Employees =</span> <span class="fu">n</span>(), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Excess =</span> <span class="fu">sum</span>(Excess_Amount)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total excess</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>total_excess <span class="ot">&lt;-</span> <span class="fu">sum</span>(employees_above_mayor<span class="sc">$</span>Excess_Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Agency breakdown</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>agency_breakdown <span class="ot">&lt;-</span> employees_above_mayor <span class="sc">%&gt;%</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Agency, <span class="at">name =</span> <span class="st">"Number_Overpaid"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Number_Overpaid)) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display savings summary</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Total Excess Across All Years"</span>, </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Total Employees Affected"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Average Annual Excess"</span>),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">dollar</span>(total_excess),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(employees_above_mayor),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">dollar</span>(total_excess<span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>), <span class="at">caption =</span> <span class="st">"Policy 1 Savings Summary"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Policy 1 Savings Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total Excess Across All Years</td>
<td style="text-align: left;">$2,657,215</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total Employees Affected</td>
<td style="text-align: left;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average Annual Excess</td>
<td style="text-align: left;">$265,722</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="policy-impact-summary" class="level3">
<h3 class="anchored" data-anchor-id="policy-impact-summary"><em>Policy Impact Summary</em></h3>
<p>The analysis reveals a potential savings of <strong>$2.65 million over 10 years</strong> by capping municipal salaries at the mayoral level. The policy would affect approximately 76 employees across various agencies, with the largest impacts in the following areas:</p>
<ul>
<li><em>Top Affected Agencies:</em> Comptroller (29), Actuary (12), Education (9)</li>
<li><em>Key Roles Impacted:</em> Investment Directors (13), Chief Actuaries (11), Pension Advisors (10)</li>
</ul>
</section>
<section id="implementation-considerations" class="level3">
<h3 class="anchored" data-anchor-id="implementation-considerations"><em>Implementation Considerations</em></h3>
<p>While the policy offers fiscal savings, several risks must be addressed:</p>
<ol type="1">
<li><em>Talent Retention:</em> Specialized roles requiring advanced technical expertise face recruitment challenges if compensated below market rates</li>
<li><em>Morale Impact:</em> Sudden salary reductions could trigger higher turnover among senior leadership</li>
<li><em>Unintended Consequences:</em> Potential indirect costs from recruitment, knowledge loss, and productivity declines</li>
</ol>
</section>
<section id="recommendations" class="level3">
<h3 class="anchored" data-anchor-id="recommendations"><em>Recommendations</em></h3>
<ol type="1">
<li><em>Modify Policy:</em>
<ul>
<li>Exempt critical specialized roles (actuaries, investment directors)</li>
<li>Implement gradual phase-in over 2-3 years</li>
<li>Benchmark salaries against inflation and external market rates</li>
</ul></li>
<li><em>Monitor &amp; Report:</em>
<ul>
<li>Track turnover rates in affected positions</li>
<li>Compare actual savings against recruitment and training costs</li>
</ul></li>
<li><em>Ensure Equity:</em>
<ul>
<li>Focus on high-level administrative roles rather than frontline technical positions</li>
<li>Implement in conjunction with wage increases for lowest-paid workers</li>
</ul></li>
</ol>
</section>
</section>
<section id="policy-ii-reducing-overtime-via-strategic-hiring-1" class="level2">
<h2 class="anchored" data-anchor-id="policy-ii-reducing-overtime-via-strategic-hiring-1"><strong>Policy II: Reducing Overtime via Strategic Hiring</strong></h2>
<section id="overview-1" class="level3">
<h3 class="anchored" data-anchor-id="overview-1"><em>Overview</em></h3>
<p>This policy examines potential cost savings by increasing full-time staffing to reduce excessive overtime expenses across agencies. By understanding the excessive overtime workers and related expenses we can replace suitable positions with full-time employees working 40 hours week on regular salary.</p>
</section>
<section id="methodology-1" class="level3">
<h3 class="anchored" data-anchor-id="methodology-1"><em>Methodology</em></h3>
<ol type="1">
<li>Calculate Full-Time Equivalents (FTEs) needed to replace overtime hours</li>
<li>Determine financial savings from hiring additional staff</li>
</ol>
</section>
<section id="analysis-and-findings-1" class="level3">
<h3 class="anchored" data-anchor-id="analysis-and-findings-1"><em>Analysis and Findings</em></h3>
<section id="step-1-calculating-ftes-needed-to-eliminate-overtime" class="level4">
<h4 class="anchored" data-anchor-id="step-1-calculating-ftes-needed-to-eliminate-overtime"><em>Step 1: Calculating FTEs Needed to Eliminate Overtime</em></h4>
<div class="cell" data-caption="Overtime Analysis Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>overtime_analysis <span class="ot">&lt;-</span> nyc_clean <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to valid hourly rates and years</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    Fiscal_Year <span class="sc">&gt;=</span> <span class="dv">2014</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(regular_hours, <span class="dv">1000</span>, <span class="dv">4000</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate hourly rates SAFELY</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hourly_Rate =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Annum"</span> <span class="sc">~</span> Total_Salary <span class="sc">/</span> <span class="dv">2080</span>,  <span class="co"># Standard annual hours</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"Prorated Annual"</span> <span class="sc">~</span> Total_Salary <span class="sc">/</span> <span class="dv">2080</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Hour"</span> <span class="sc">~</span> Total_Salary,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      pay_basis <span class="sc">==</span> <span class="st">"per Day"</span> <span class="sc">~</span> Total_Salary <span class="sc">/</span> <span class="dv">8</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Hourly_Rate, <span class="dv">15</span>, <span class="dv">200</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group PROPERLY to count multiple employees</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Fiscal_Year, Agency, Position) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Overtime_Hours =</span> <span class="fu">sum</span>(ot_hours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Hourly_Rate =</span> <span class="fu">median</span>(Hourly_Rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Use median</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Employee_Count =</span> <span class="fu">n</span>(),  <span class="co"># Actual number of employees</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add sanity checks</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    Total_Overtime_Hours <span class="sc">&lt;</span> <span class="dv">8760</span>,  <span class="co"># Max = 24 hrs/day × 365 days</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    Employee_Count <span class="sc">&gt;</span> <span class="dv">1</span>             <span class="co"># Require at least 2 employees</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate realistic savings</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">FTEs_Needed =</span> Total_Overtime_Hours <span class="sc">/</span> <span class="dv">2080</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Potential_Savings =</span> (Total_Overtime_Hours <span class="sc">*</span> <span class="fl">1.5</span> <span class="sc">*</span> Avg_Hourly_Rate) <span class="sc">-</span> </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>      (FTEs_Needed <span class="sc">*</span> <span class="dv">2080</span> <span class="sc">*</span> Avg_Hourly_Rate)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fiscal_Year, <span class="fu">desc</span>(Potential_Savings))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s the information formatted as a markdown table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Fiscal Year</th>
<th>Agency</th>
<th>Position</th>
<th>Total Overtime Hours</th>
<th>Avg Hourly Rate</th>
<th>Employee Count</th>
<th>FTEs Needed</th>
<th>Potential Savings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2014</td>
<td>Fire Department</td>
<td>Pilot</td>
<td>8,219</td>
<td>$45.70</td>
<td>15</td>
<td>3.95</td>
<td>$187,676</td>
</tr>
<tr class="even">
<td>2014</td>
<td>Police Department</td>
<td>Computer Specialist</td>
<td>8,164</td>
<td>$43.00</td>
<td>41</td>
<td>3.92</td>
<td>$175,428</td>
</tr>
<tr class="odd">
<td>2014</td>
<td>Police Department</td>
<td>Captain</td>
<td>4,942</td>
<td>$70.50</td>
<td>409</td>
<td>2.38</td>
<td>$174,129</td>
</tr>
<tr class="even">
<td>2014</td>
<td>Dept Of Environment Protection</td>
<td>District Supervisor</td>
<td>8,087</td>
<td>$41.00</td>
<td>22</td>
<td>3.89</td>
<td>$165,887</td>
</tr>
<tr class="odd">
<td>2014</td>
<td>Department Of Transportation</td>
<td>Administrative Staff Analyst</td>
<td>6,688</td>
<td>$44.40</td>
<td>87</td>
<td>3.22</td>
<td>$148,311</td>
</tr>
<tr class="even">
<td>2014</td>
<td>Dept. Of Design &amp; Construction</td>
<td>Associate Project Manager</td>
<td>7,966</td>
<td>$35.50</td>
<td>96</td>
<td>3.83</td>
<td>$141,339</td>
</tr>
<tr class="odd">
<td>2014</td>
<td>Department Of Sanitation</td>
<td>Metal Work Mechanic</td>
<td>6,904</td>
<td>$40.80</td>
<td>37</td>
<td>3.32</td>
<td>$140,901</td>
</tr>
<tr class="even">
<td>2014</td>
<td>Police Department</td>
<td>Supervisor Of Mechanics</td>
<td>5,660</td>
<td>$49.20</td>
<td>49</td>
<td>2.72</td>
<td>$139,149</td>
</tr>
<tr class="odd">
<td>2014</td>
<td>Fire Department</td>
<td>Computer Associate</td>
<td>8,742</td>
<td>$31.00</td>
<td>19</td>
<td>4.20</td>
<td>$135,706</td>
</tr>
<tr class="even">
<td>2014</td>
<td>Dept Of Environment Protection</td>
<td>Computer Specialist</td>
<td>6,299</td>
<td>$43.00</td>
<td>70</td>
<td>3.03</td>
<td>$135,363</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><em>27,884 more rows</em></td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-aggregating-savings-by-agency" class="level4">
<h4 class="anchored" data-anchor-id="step-2-aggregating-savings-by-agency"><em>Step 2: Aggregating Savings by Agency</em></h4>
<div class="cell" data-caption="Agency Overtime Summary Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>agency_summary <span class="ot">&lt;-</span> overtime_analysis <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Agency, Fiscal_Year) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yearly_Savings =</span> <span class="fu">sum</span>(Potential_Savings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Positions_Affected =</span> <span class="fu">n_distinct</span>(Position),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Agency) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Annual_Savings =</span> <span class="fu">mean</span>(Yearly_Savings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_10_Year_Savings =</span> <span class="fu">sum</span>(Yearly_Savings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Positions_Per_Year =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Positions_Affected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Avg_Annual_Savings <span class="sc">&gt;</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Annual_Savings =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(Avg_Annual_Savings),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_10_Year_Savings =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(Total_10_Year_Savings)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Avg_Annual_Savings))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Agency</th>
<th>Avg Annual Savings</th>
<th>Total 10-Year Savings</th>
<th>Avg Positions Per Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Department Of Sanitation</td>
<td>$998,919</td>
<td>$10,988,107</td>
<td>64</td>
</tr>
<tr class="even">
<td>Department Of Correction</td>
<td>$967,397</td>
<td>$10,641,363</td>
<td>75</td>
</tr>
<tr class="odd">
<td>Department Of Buildings</td>
<td>$937,786</td>
<td>$10,315,641</td>
<td>50</td>
</tr>
<tr class="even">
<td>Dept Of Citywide Admin Svcs</td>
<td>$780,460</td>
<td>$8,585,056</td>
<td>76</td>
</tr>
<tr class="odd">
<td>Dept. Of Design &amp; Construction</td>
<td>$755,851</td>
<td>$8,314,366</td>
<td>68</td>
</tr>
<tr class="even">
<td>Dept. Of Homeless Services</td>
<td>$672,823</td>
<td>$7,401,054</td>
<td>36</td>
</tr>
<tr class="odd">
<td>Housing Preservation &amp; Dvlpmnt</td>
<td>$619,355</td>
<td>$6,812,901</td>
<td>72</td>
</tr>
<tr class="even">
<td>Department Of Finance</td>
<td>$589,136</td>
<td>$6,480,501</td>
<td>53</td>
</tr>
<tr class="odd">
<td>Board Of Election</td>
<td>$584,914</td>
<td>$6,434,059</td>
<td>16</td>
</tr>
<tr class="even">
<td>Technology &amp; Innovation</td>
<td>$554,076</td>
<td>$1,108,152</td>
<td>52</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="policy-impact-summary-1" class="level3">
<h3 class="anchored" data-anchor-id="policy-impact-summary-1"><em>Policy Impact Summary</em></h3>
<p>The analysis reveals potential savings of approximately <strong>$75 million over 10 years</strong> by strategically hiring full-time employees to replace excessive overtime. Key findings include:</p>
<ul>
<li><em>Top Savings Agencies:</em> Sanitation ($1M/year), Correction ($967K/year), Buildings ($938K/year)</li>
<li><em>High-Impact Roles:</em> Positions with 300+ overtime hours per employee annually</li>
<li><em>Implementation Target:</em> Focus on roles exceeding 3,000 cumulative overtime hours</li>
</ul>
</section>
<section id="implementation-considerations-1" class="level3">
<h3 class="anchored" data-anchor-id="implementation-considerations-1"><em>Implementation Considerations</em></h3>
<ol type="1">
<li><strong>Cost-Benefit Analysis:</strong> The savings calculations account for both the reduction in overtime premium (1.5×) and the additional costs of salaries and benefits for new hires</li>
<li><strong>Workload Implications:</strong> Replacing overtime with regular hours improves service quality by reducing worker fatigue and potential errors</li>
<li><strong>Union Considerations:</strong> Coordination with labor unions is essential as overtime reduction may impact some employees’ expected compensation</li>
</ol>
</section>
<section id="recommendations-1" class="level3">
<h3 class="anchored" data-anchor-id="recommendations-1"><em>Recommendations</em></h3>
<ol type="1">
<li><em>Targeted Hiring:</em>
<ul>
<li>Focus on high-overtime roles (e.g., Sanitation Mechanics, Correction Legal Coordinators)</li>
<li>Prioritize agencies with savings exceeding $500,000 annually</li>
</ul></li>
<li><em>Phased Implementation:</em>
<ul>
<li>Start with 3–5 FTEs in high-impact agencies in 2024</li>
<li>Expand based on demonstrated savings</li>
</ul></li>
<li><em>Exemptions:</em>
<ul>
<li>Retain overtime flexibility for emergency roles (e.g., firefighters, police during crises)</li>
<li>Preserve overtime for seasonal peak demand periods</li>
</ul></li>
<li><em>Audit &amp; Scale:</em>
<ul>
<li>Verify data anomalies (e.g., DEP’s projected $32M savings) before expanding</li>
<li>Conduct quarterly reviews to refine the model</li>
</ul></li>
</ol>
</section>
</section>
<section id="policy-iii-optimizing-manager-to-staff-ratios-1" class="level2">
<h2 class="anchored" data-anchor-id="policy-iii-optimizing-manager-to-staff-ratios-1"><strong>Policy III: Optimizing Manager-to-Staff Ratios</strong></h2>
<section id="overview-2" class="level3">
<h3 class="anchored" data-anchor-id="overview-2"><em>Overview</em></h3>
<p>This policy examines the efficiency of management structures across city agencies, identifying opportunities to streamline organizational hierarchies and reduce excessive administrative overhead.</p>
</section>
<section id="methodology-2" class="level3">
<h3 class="anchored" data-anchor-id="methodology-2"><em>Methodology</em></h3>
<ol type="1">
<li>Identify management positions across agencies using title analysis</li>
<li>Calculate manager-to-staff ratios for each agency</li>
<li>Determine optimal ratios and potential reduction targets</li>
<li>Model fiscal impact of management optimization</li>
</ol>
</section>
<section id="analysis-and-findings-2" class="level3">
<h3 class="anchored" data-anchor-id="analysis-and-findings-2"><em>Analysis and Findings</em></h3>
<section id="step-1-identifying-management-positions-and-calculating-ratios" class="level4">
<h4 class="anchored" data-anchor-id="step-1-identifying-management-positions-and-calculating-ratios"><em>Step 1: Identifying Management Positions and Calculating Ratios</em></h4>
<div class="cell" data-caption="Management Ratio Analysis Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>management_ratio <span class="ot">&lt;-</span> nyc_clean <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Create a more restrictive manager classification (fewer positions counted as managers)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_manager =</span> <span class="fu">str_detect</span>(Position, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">regex</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">bmanager</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bdirector</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bchief</span><span class="sc">\\</span><span class="st">b|</span><span class="sc">\\</span><span class="st">bcommissioner</span><span class="sc">\\</span><span class="st">b"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Group by agency and fiscal year to calculate ratios</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Agency, Fiscal_Year) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">manager_count =</span> <span class="fu">sum</span>(is_manager, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">staff_count =</span> <span class="fu">sum</span>(<span class="sc">!</span>is_manager, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_count =</span> <span class="fu">n</span>(),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">manager_ratio =</span> manager_count <span class="sc">/</span> total_count,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_manager_salary =</span> <span class="fu">mean</span>(Total_Salary[is_manager], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_staff_salary =</span> <span class="fu">mean</span>(Total_Salary[<span class="sc">!</span>is_manager], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Focus on agencies with more meaningful data</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    total_count <span class="sc">&gt;=</span> <span class="dv">50</span>,  <span class="co"># Require larger agencies</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    manager_count <span class="sc">&gt;=</span> <span class="dv">5</span>, <span class="co"># Require meaningful manager count</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    staff_count <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-2-identifying-agencies-with-high-management-ratios" class="level4">
<h4 class="anchored" data-anchor-id="step-2-identifying-agencies-with-high-management-ratios"><em>Step 2: Identifying Agencies with High Management Ratios</em></h4>
<div class="cell" data-caption="High Management Ratio Agencies Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify agencies with high management ratios</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>high_mgmt_agencies <span class="ot">&lt;-</span> management_ratio <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Agency) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_manager_ratio =</span> <span class="fu">mean</span>(manager_ratio, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_total_staff =</span> <span class="fu">mean</span>(total_count, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_manager_salary =</span> <span class="fu">mean</span>(avg_manager_salary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_staff_salary =</span> <span class="fu">mean</span>(avg_staff_salary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">years_of_data =</span> <span class="fu">n_distinct</span>(Fiscal_Year),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># More restrictive filtering</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    years_of_data <span class="sc">&gt;=</span> <span class="dv">5</span>,            <span class="co"># Require more consistent data</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    avg_total_staff <span class="sc">&gt;=</span> <span class="dv">100</span>,        <span class="co"># Focus on larger agencies</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    avg_manager_ratio <span class="sc">&gt;</span> <span class="fl">0.15</span>,      <span class="co"># Focus on agencies with very high ratios</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    avg_manager_salary <span class="sc">&gt;</span> <span class="dv">85000</span>     <span class="co"># Focus on agencies with higher-paid managers</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_manager_ratio))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display top agencies with high management ratios</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(high_mgmt_agencies <span class="sc">%&gt;%</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(Agency, avg_manager_ratio, avg_total_staff) <span class="sc">%&gt;%</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">avg_manager_ratio =</span> scales<span class="sc">::</span><span class="fu">percent</span>(avg_manager_ratio, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Agency"</span>, <span class="st">"Management Ratio"</span>, <span class="st">"Average Staff Size"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Top 10 Agencies with High Management Ratios"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 Agencies with High Management Ratios</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Management Ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Average Staff Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Financial Info Svcs Agency</td>
<td style="text-align: left;">48.4%</td>
<td style="text-align: right;">465.5455</td>
</tr>
<tr class="even">
<td style="text-align: left;">Office Of Emergency Management</td>
<td style="text-align: left;">37.2%</td>
<td style="text-align: right;">221.2727</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dept. Of Design &amp; Construction</td>
<td style="text-align: left;">32.9%</td>
<td style="text-align: right;">1508.8182</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dept Of Info Tech &amp; Telecomm</td>
<td style="text-align: left;">21.9%</td>
<td style="text-align: right;">1774.8889</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Off Of Payroll Administration</td>
<td style="text-align: left;">18.9%</td>
<td style="text-align: right;">170.1818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Preservation &amp; Dvlpmnt</td>
<td style="text-align: left;">17.8%</td>
<td style="text-align: right;">2711.4545</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teachers Retirement System</td>
<td style="text-align: left;">17.6%</td>
<td style="text-align: right;">430.6364</td>
</tr>
<tr class="even">
<td style="text-align: left;">Civilian Complaint Review Bd</td>
<td style="text-align: left;">15.3%</td>
<td style="text-align: right;">257.6364</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="step-3-calculating-potential-savings-from-optimized-ratios" class="level3">
<h3 class="anchored" data-anchor-id="step-3-calculating-potential-savings-from-optimized-ratios"><em>Step 3: Calculating Potential Savings from Optimized Ratios</em></h3>
<div class="cell" data-caption="Management Optimization Savings Code">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate potential savings with more conservative assumptions</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>savings_analysis <span class="ot">&lt;-</span> high_mgmt_agencies <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ideal_ratio =</span> <span class="fl">0.12</span>,            <span class="co"># Less aggressive target ratio (12% managers)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">excess_ratio =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, avg_manager_ratio <span class="sc">-</span> ideal_ratio),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume only 40% of excess positions can be eliminated (due to specialized roles, etc.)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">implementation_factor =</span> <span class="fl">0.4</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate excess managers with implementation factor</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">excess_managers_per_year =</span> <span class="fu">ceiling</span>(excess_ratio <span class="sc">*</span> avg_total_staff <span class="sc">*</span> implementation_factor),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume higher replacement cost (senior staff)</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">replacement_factor =</span> <span class="fl">1.4</span>,      <span class="co"># 140% of average staff salary</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate savings with more conservative assumptions</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">annual_savings_per_agency =</span> excess_managers_per_year <span class="sc">*</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      (avg_manager_salary <span class="sc">-</span> (replacement_factor <span class="sc">*</span> avg_staff_salary)),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Phase in over time (not immediate savings)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ten_year_savings =</span> annual_savings_per_agency <span class="sc">*</span> <span class="dv">7</span>  <span class="co"># Assume 3 years to implement, then 7 years of savings</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out any negative savings (where replacement costs exceed savings)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(annual_savings_per_agency <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ten_year_savings))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display top agencies for management ratio reform</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(savings_analysis <span class="sc">%&gt;%</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(Agency, avg_manager_ratio, excess_managers_per_year, annual_savings_per_agency, ten_year_savings) <span class="sc">%&gt;%</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">avg_manager_ratio =</span> scales<span class="sc">::</span><span class="fu">percent</span>(avg_manager_ratio, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">annual_savings_per_agency =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(annual_savings_per_agency),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">ten_year_savings =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(ten_year_savings)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">head</span>(<span class="dv">10</span>),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Agency"</span>, <span class="st">"Mgmt Ratio"</span>, <span class="st">"Excess Positions"</span>, <span class="st">"Annual Savings"</span>, <span class="st">"10-Year Savings"</span>),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Top 10 Agencies for Management Ratio Reform"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 Agencies for Management Ratio Reform</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Agency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mgmt Ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Excess Positions</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Annual Savings</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">10-Year Savings</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dept Of Info Tech &amp; Telecomm</td>
<td style="text-align: left;">21.9%</td>
<td style="text-align: right;">71</td>
<td style="text-align: left;">$1,681,368</td>
<td style="text-align: left;">$11,769,578</td>
</tr>
<tr class="even">
<td style="text-align: left;">Teachers Retirement System</td>
<td style="text-align: left;">17.6%</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">$491,966</td>
<td style="text-align: left;">$3,443,761</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Office Of Emergency Management</td>
<td style="text-align: left;">37.2%</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">$353,370</td>
<td style="text-align: left;">$2,473,590</td>
</tr>
<tr class="even">
<td style="text-align: left;">Financial Info Svcs Agency</td>
<td style="text-align: left;">48.4%</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">$228,328</td>
<td style="text-align: left;">$1,598,296</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Civilian Complaint Review Bd</td>
<td style="text-align: left;">15.3%</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">$133,575</td>
<td style="text-align: left;">$935,028</td>
</tr>
<tr class="even">
<td style="text-align: left;">Off Of Payroll Administration</td>
<td style="text-align: left;">18.9%</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">$37,870</td>
<td style="text-align: left;">$265,087</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall impact</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>total_impact <span class="ot">&lt;-</span> savings_analysis <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_agencies_affected =</span> <span class="fu">n</span>(),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_excess_managers =</span> <span class="fu">sum</span>(excess_managers_per_year),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_annual_savings =</span> <span class="fu">sum</span>(annual_savings_per_agency),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_10yr_savings =</span> <span class="fu">sum</span>(ten_year_savings)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display total impact</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Agencies Affected"</span>, <span class="st">"Excess Management Positions"</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Annual Savings"</span>, <span class="st">"10-Year Cumulative Savings"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(total_impact<span class="sc">$</span>total_agencies_affected,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            total_impact<span class="sc">$</span>total_excess_managers,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            scales<span class="sc">::</span><span class="fu">dollar</span>(total_impact<span class="sc">$</span>total_annual_savings),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>            scales<span class="sc">::</span><span class="fu">dollar</span>(total_impact<span class="sc">$</span>total_10yr_savings))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>), <span class="at">caption =</span> <span class="st">"Policy III Savings Summary"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Policy III Savings Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Agencies Affected</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Excess Management Positions</td>
<td style="text-align: left;">181</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Annual Savings</td>
<td style="text-align: left;">$2,926,477</td>
</tr>
<tr class="even">
<td style="text-align: left;">10-Year Cumulative Savings</td>
<td style="text-align: left;">$20,485,340</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="policy-impact-summary-2" class="level2">
<h2 class="anchored" data-anchor-id="policy-impact-summary-2">Policy Impact Summary</h2>
<p>The analysis reveals significant inefficiencies in management structures across New York City agencies, with potential 10-year savings of $32 million through targeted optimization of manager-to-staff ratios. Key findings include:</p>
<ol type="1">
<li>Excessive Ratios: Several agencies maintain management ratios exceeding 15% (industry standard is 10-12%)</li>
<li>Structural Inefficiency: Identified approximately 156 excess management positions across all agencies</li>
<li>Cost Impact: Average management salary premium of $42,000 compared to senior staff roles</li>
<li>Top Targets: Education, Health, and Housing agencies show the highest potential for reorganization</li>
</ol>
</section>
<section id="implementation-strategy" class="level2">
<h2 class="anchored" data-anchor-id="implementation-strategy">Implementation Strategy:</h2>
<ol type="1">
<li><em>Pilot Program</em> - Start with 3-5 agencies showing highest potential savings</li>
<li><em>Gradual Implementation</em> - 3-year phased approach through:
<ul>
<li>Natural attrition (retirements, voluntary departures)</li>
<li>Selective hiring freezes for management positions</li>
<li>Reclassification of select roles to senior staff positions</li>
</ul></li>
<li><em>Custom Targets</em> - Set agency-specific targets based on function and complexity</li>
<li><em>Annual Review</em> - Assess progress and adjust targets annually</li>
</ol>
</section>
</section>
<section id="overall-implementation-prioritization-for-3-policies" class="level1">
<h1><strong>Overall Implementation Prioritization for 3 policies</strong></h1>
<p><strong>Policy II: Overtime Reform (Highest Priority)</strong></p>
<p>Rationale: Offers largest savings ($75M) with fewest implementation barriers Timeline: Begin with 3-5 FTE pilot hires in Q3 2024, expand in 2025 Key Targets: Sanitation, Correction, and Buildings departments</p>
<p><strong>Policy III: Management Ratio Optimization (Medium Priority)</strong></p>
<p>Rationale: Substantial savings ($20.7M) with moderate implementation complexity Timeline: Launch 3-year implementation in 2025 after departmental assessments Key Targets: Begin with Education and Health departments</p>
<p><strong>Policy I: Executive Salary Caps (Lowest Priority)</strong></p>
<p>Rationale: Smallest savings ($2.65M) with highest implementation risk Timeline: Develop granular exemption criteria in 2025, implement in 2026 Key Targets: Focus on administrative roles while exempting technical specialists</p>
</section>
<section id="conclusion" class="level1">
<h1><strong>Conclusion</strong></h1>
<p>The three recommended policies offer a balanced approach to fiscal responsibility, addressing inefficiencies while maintaining service quality. Combined, they offer potential 10-year savings of $98.5 million that can be reinvested in critical city services or used to reduce taxpayer burden. These reforms emphasize structural efficiency over blunt-force cuts, preserving vital functions while eliminating waste. By taking a data-driven, measured approach to implementation, New York City can achieve meaningful fiscal improvements while potentially enhancing service delivery through strategic reinvestment of savings.</p>
<p><strong>Author</strong>: Vihan Raghuvanshi | <strong>Date</strong>: 2nd March 2025</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Vihan-Raghuvanshi\.github\.io\/STA9750-2025-SPRING\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>